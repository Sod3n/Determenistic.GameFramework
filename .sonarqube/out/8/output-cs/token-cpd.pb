é
p/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Program.cs
var 
example 
= 
args 
. 
Length 
> 
$num 
? 
args  $
[$ %
$num% &
]& '
:( )
$str* -
;- .
switch 
( 
example 
) 
{ 
case

 
$str

	 
:

  
Example01_HelloWorld

 "
.

" #
Run

# &
(

& '
)

' (
;

( )
break

* /
;

/ 0
case 
$str	 
: 
Example02_Reactions !
.! "
Run" %
(% &
)& '
;' (
break) .
;. /
case 
$str	 
: %
Example03_DomainHierarchy '
.' (
Run( +
(+ ,
), -
;- .
break/ 4
;4 5
case 
$str	 
: *
Example04_ObservableAttributes ,
., -
Run- 0
(0 1
)1 2
;2 3
break4 9
;9 :
case 
$str	 
: $
Example05_NetworkActions &
.& '
Run' *
(* +
)+ ,
;, -
break. 3
;3 4
case 
$str	 
: %
Example06_ActionInjection '
.' (
Run( +
(+ ,
), -
;- .
break/ 4
;4 5
case 
$str	 
:  
Example07_DuckTyping "
." #
Run# &
(& '
)' (
;( )
break* /
;/ 0
default 
: 
Console 
. 
	WriteLine 
( 
$str ;
); <
;< =
break> C
;C D
} á
ï/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/QuickStart/RockPaperScissorsExample.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
.. /

QuickStart/ 9
;9 :
public 
static 
class $
RockPaperScissorsExample ,
{ 
public 

static 
void 
Run 
( 
) 
{ 
Console		 
.		 
	WriteLine		 
(		 
$str		 9
)		9 :
;		: ;
var 
game 
= 
new !
RockPaperScissorsGame ,
(, -
)- .
;. /
var 
gameLoop 
= 
new 
GameLoop #
(# $
)$ %
;% &
gameLoop 
. 
	AddDomain 
( 
game 
)  
;  !
SimulateGame 
( 
game 
, 
gameLoop #
)# $
;$ %
Console 
. 
	WriteLine 
( 
$str (
)( )
;) *
} 
private 
static 
void 
SimulateGame $
($ %!
RockPaperScissorsGame% :
game; ?
,? @
GameLoopA I
gameLoopJ R
)R S
{ 
var 
random 
= 
new 
Random 
(  
$num  "
)" #
;# $
while 
( 
game 
. 
Winner 
== 
null "
)" #
{ 	
var 
p1Choice 
= 
( 
Choice "
)" #
random# )
.) *
Next* .
(. /
$num/ 0
)0 1
;1 2
var   
action1   
=   
new   
MakeChoiceAction   .
{!! 

PlayerName"" 
="" 
game"" !
.""! "
Player1""" )
."") *
Name""* .
,"". /
Choice## 
=## 
p1Choice## !
}$$ 
;$$ 
gameLoop%% 
.%% 
ExecuteAction%% "
(%%" #
action1%%# *
)%%* +
;%%+ ,
Thread(( 
.(( 
Sleep(( 
((( 
$num(( 
)(( 
;(( 
var++ 
p2Choice++ 
=++ 
(++ 
Choice++ "
)++" #
random++# )
.++) *
Next++* .
(++. /
$num++/ 0
)++0 1
;++1 2
var,, 
action2,, 
=,, 
new,, 
MakeChoiceAction,, .
{-- 

PlayerName.. 
=.. 
game.. !
...! "
Player2.." )
...) *
Name..* .
,... /
Choice// 
=// 
p2Choice// !
}00 
;00 
gameLoop11 
.11 
ExecuteAction11 "
(11" #
action211# *
)11* +
;11+ ,
if44 
(44 
game44 
.44 
Winner44 
==44 
null44 #
)44# $
{55 
Thread66 
.66 
Sleep66 
(66 
$num66 !
)66! "
;66" #
Console77 
.77 
	WriteLine77 !
(77! "
$str77" 8
)778 9
;779 :
}88 
}99 	
}:: 
};; ŸB
ç/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/QuickStart/MakeChoiceAction.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
.. /

QuickStart/ 9
;9 :
public 
class 
MakeChoiceAction 
: 
	DARAction  )
<) *!
RockPaperScissorsGame* ?
,? @
MakeChoiceActionA Q
>Q R
{		 
public

 

string

 

PlayerName

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
=

+ ,
$str

- /
;

/ 0
public 

Choice 
Choice 
{ 
get 
; 
set  #
;# $
}% &
	protected 
override 
void 
ExecuteProcess *
(* +!
RockPaperScissorsGame+ @
domainA G
)G H
{ 
var 
player 
= 
domain 
. 
Player1 #
.# $
Name$ (
==) +

PlayerName, 6
?7 8
domain9 ?
.? @
Player1@ G
:H I
domainJ P
.P Q
Player2Q X
;X Y
player 
. 
CurrentChoice 
= 
Choice %
;% &
Console 
. 
	WriteLine 
( 
$" 
{ 

PlayerName '
}' (
$str( /
{/ 0
Choice0 6
}6 7
"7 8
)8 9
;9 :
if 

( 
domain 
. 
Player1 
. 
CurrentChoice (
.( )
HasValue) 1
&&2 4
domain5 ;
.; <
Player2< C
.C D
CurrentChoiceD Q
.Q R
HasValueR Z
)Z [
{ 	
ResolveRound 
( 
domain 
)  
;  !
} 	
} 
private 
void 
ResolveRound 
( !
RockPaperScissorsGame 3
game4 8
)8 9
{   
var!! 
p1Choice!! 
=!! 
game!! 
.!! 
Player1!! #
.!!# $
CurrentChoice!!$ 1
!!!1 2
.!!2 3
Value!!3 8
;!!8 9
var"" 
p2Choice"" 
="" 
game"" 
."" 
Player2"" #
.""# $
CurrentChoice""$ 1
!""1 2
.""2 3
Value""3 8
;""8 9
Console$$ 
.$$ 
	WriteLine$$ 
($$ 
$"$$ 
$str$$ $
{$$$ %
game$$% )
.$$) *
RoundNumber$$* 5
}$$5 6
$str$$6 7
"$$7 8
)$$8 9
;$$9 :
Console%% 
.%% 
	WriteLine%% 
(%% 
$"%% 
$str%% 
{%% 
game%% #
.%%# $
Player1%%$ +
.%%+ ,
Name%%, 0
}%%0 1
$str%%1 3
{%%3 4
p1Choice%%4 <
}%%< =
"%%= >
)%%> ?
;%%? @
Console&& 
.&& 
	WriteLine&& 
(&& 
$"&& 
$str&& 
{&& 
game&& #
.&&# $
Player2&&$ +
.&&+ ,
Name&&, 0
}&&0 1
$str&&1 3
{&&3 4
p2Choice&&4 <
}&&< =
"&&= >
)&&> ?
;&&? @
if)) 

()) 
p1Choice)) 
==)) 
p2Choice))  
)))  !
{** 	
Console++ 
.++ 
	WriteLine++ 
(++ 
$str++ /
)++/ 0
;++0 1
},, 	
else-- 
if-- 
(-- 
IsWinner-- 
(-- 
p1Choice-- "
,--" #
p2Choice--$ ,
)--, -
)--- .
{.. 	
game// 
.// 
Player1// 
.// 
Score// 
++//  
;//  !
Console00 
.00 
	WriteLine00 
(00 
$"00  
$str00  *
{00* +
game00+ /
.00/ 0
Player1000 7
.007 8
Name008 <
}00< =
$str00= >
"00> ?
)00? @
;00@ A
}11 	
else22 
{33 	
game44 
.44 
Player244 
.44 
Score44 
++44  
;44  !
Console55 
.55 
	WriteLine55 
(55 
$"55  
$str55  *
{55* +
game55+ /
.55/ 0
Player2550 7
.557 8
Name558 <
}55< =
$str55= >
"55> ?
)55? @
;55@ A
}66 	
Console88 
.88 
	WriteLine88 
(88 
$"88 
$str88 %
{88% &
game88& *
.88* +
Player188+ 2
.882 3
Name883 7
}887 8
$str888 9
{889 :
game88: >
.88> ?
Player188? F
.88F G
Score88G L
}88L M
$str88M P
{88P Q
game88Q U
.88U V
Player288V ]
.88] ^
Score88^ c
}88c d
$str88d e
{88e f
game88f j
.88j k
Player288k r
.88r s
Name88s w
}88w x
$str88x z
"88z {
)88{ |
;88| }
if;; 

(;; 
game;; 
.;; 
Player1;; 
.;; 
Score;; 
>=;; !
$num;;" #
);;# $
{<< 	
game== 
.== 
Winner== 
=== 
game== 
.== 
Player1== &
.==& '
Name==' +
;==+ ,
Console>> 
.>> 
	WriteLine>> 
(>> 
$">>  
$str>>  #
{>># $
game>>$ (
.>>( )
Player1>>) 0
.>>0 1
Name>>1 5
}>>5 6
$str>>6 E
">>E F
)>>F G
;>>G H
}?? 	
else@@ 
if@@ 
(@@ 
game@@ 
.@@ 
Player2@@ 
.@@ 
Score@@ #
>=@@$ &
$num@@' (
)@@( )
{AA 	
gameBB 
.BB 
WinnerBB 
=BB 
gameBB 
.BB 
Player2BB &
.BB& '
NameBB' +
;BB+ ,
ConsoleCC 
.CC 
	WriteLineCC 
(CC 
$"CC  
$strCC  #
{CC# $
gameCC$ (
.CC( )
Player2CC) 0
.CC0 1
NameCC1 5
}CC5 6
$strCC6 E
"CCE F
)CCF G
;CCG H
}DD 	
elseEE 
{FF 	
gameHH 
.HH 
RoundNumberHH 
++HH 
;HH 
gameII 
.II 
Player1II 
.II 
CurrentChoiceII &
=II' (
nullII) -
;II- .
gameJJ 
.JJ 
Player2JJ 
.JJ 
CurrentChoiceJJ &
=JJ' (
nullJJ) -
;JJ- .
}KK 	
}LL 
privateNN 
boolNN 
IsWinnerNN 
(NN 
ChoiceNN  
aNN! "
,NN" #
ChoiceNN$ *
bNN+ ,
)NN, -
{OO 
returnPP 
(PP 
aPP 
==PP 
ChoicePP 
.PP 
RockPP  
&&PP! #
bPP$ %
==PP& (
ChoicePP) /
.PP/ 0
ScissorsPP0 8
)PP8 9
||PP: <
(QQ 
aQQ 
==QQ 
ChoiceQQ 
.QQ 
PaperQQ !
&&QQ" $
bQQ% &
==QQ' )
ChoiceQQ* 0
.QQ0 1
RockQQ1 5
)QQ5 6
||QQ7 9
(RR 
aRR 
==RR 
ChoiceRR 
.RR 
ScissorsRR $
&&RR% '
bRR( )
==RR* ,
ChoiceRR- 3
.RR3 4
PaperRR4 9
)RR9 :
;RR: ;
}SS 
}TT Ø
Ü/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/QuickStart/GameState.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
.. /

QuickStart/ 9
;9 :
public		 
class		 !
RockPaperScissorsGame		 "
:		# $
BranchDomain		% 1
{

 
public 

PlayerDomain 
Player1 
{  !
get" %
;% &
}' (
public 

PlayerDomain 
Player2 
{  !
get" %
;% &
}' (
public 

int 
RoundNumber 
{ 
get  
;  !
set" %
;% &
}' (
=) *
$num+ ,
;, -
public 

string 
? 
Winner 
{ 
get 
;  
set! $
;$ %
}& '
public 
!
RockPaperScissorsGame  
(  !
)! "
:# $
base% )
() *
null* .
). /
{ 
Player1 
= 
new 
PlayerDomain "
(" #
this# '
,' (
$str) 3
)3 4
;4 5
Player2 
= 
new 
PlayerDomain "
(" #
this# '
,' (
$str) 3
)3 4
;4 5
} 
} 
public 
class 
PlayerDomain 
: 
BranchDomain (
{ 
public 

string 
Name 
{ 
get 
; 
} 
public 

Choice 
? 
CurrentChoice  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

int 
Score 
{ 
get 
; 
set 
;  
}! "
public   

PlayerDomain   
(   
BranchDomain   $
parent  % +
,  + ,
string  - 3
name  4 8
)  8 9
:  : ;
base  < @
(  @ A
parent  A G
)  G H
{!! 
Name"" 
="" 
name"" 
;"" 
}## 
}$$ 
public)) 
enum)) 
Choice)) 
{** 
Rock++ 
,++ 	
Paper,, 	
,,,	 

Scissors-- 
}.. —X
ï/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/Network/Example07_CollectiveActions.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
.. /
Network/ 6
;6 7
public 
static 
class '
Example07_CollectiveActions /
{ 
public 

static 
void 
Run 
( 
) 
{ 
Console 
. 
	WriteLine 
( 
$str @
)@ A
;A B
var 
game 
= 
new 
LobbyGameState %
(% &
)& '
;' (
var 
player1 
= 
new 
Player  
(  !
game! %
,% &
Guid' +
.+ ,
NewGuid, 3
(3 4
)4 5
,5 6
$str7 >
)> ?
;? @
var 
player2 
= 
new 
Player  
(  !
game! %
,% &
Guid' +
.+ ,
NewGuid, 3
(3 4
)4 5
,5 6
$str7 <
)< =
;= >
var 
player3 
= 
new 
Player  
(  !
game! %
,% &
Guid' +
.+ ,
NewGuid, 3
(3 4
)4 5
,5 6
$str7 @
)@ A
;A B
Console 
. 
	WriteLine 
( 
$str ;
); <
;< =
new 
ReadyAction 
( 
) 
. 
Execute !
(! "
player1" )
)) *
;* +
new 
ReadyAction 
( 
) 
. 
Execute !
(! "
player2" )
)) *
;* +
new 
ReadyAction 
( 
) 
. 
Execute !
(! "
player3" )
)) *
;* +
Console   
.   
	WriteLine   
(   
$str   @
)  @ A
;  A B
new##  
VoteDifficultyAction##  
{##! "

Difficulty### -
=##. /
$str##0 6
}##7 8
.##8 9
Execute##9 @
(##@ A
player1##A H
)##H I
;##I J
new$$  
VoteDifficultyAction$$  
{$$! "

Difficulty$$# -
=$$. /
$str$$0 8
}$$9 :
.$$: ;
Execute$$; B
($$B C
player2$$C J
)$$J K
;$$K L
new%%  
VoteDifficultyAction%%  
{%%! "

Difficulty%%# -
=%%. /
$str%%0 6
}%%7 8
.%%8 9
Execute%%9 @
(%%@ A
player3%%A H
)%%H I
;%%I J
game'' 
.'' 
Dispose'' 
('' 
)'' 
;'' 
}(( 
})) 
public-- 
	interface-- "
IRequireLobbyGameState-- '
:--( )

IDARAction--* 4
{.. 
LobbyGameState// 
?// 
Game// 
{// 
get// 
;// 
set//  #
;//# $
}//% &
}00 
public22 
class22 
LobbyGameState22 
:22 
BranchDomain22 *
{33 
public44 
#
CollectiveActionManager44 "
CollectiveActions44# 4
{445 6
get447 :
;44: ;
}44< =
public55 

bool55 
GameStarted55 
{55 
get55 !
;55! "
set55# &
;55& '
}55( )
public66 

string66 
?66 
SelectedDifficulty66 %
{66& '
get66( +
;66+ ,
set66- 0
;660 1
}662 3
public88 

LobbyGameState88 
(88 
)88 
:88 
base88 "
(88" #
null88# '
)88' (
{99 
CollectiveActions:: 
=:: 
new:: #
CollectiveActionManager::  7
(::7 8
this::8 <
,::< =
(::> ?
)::? @
=>::A C
GetAll;; 
<;; 
Player;; 
>;; 
(;; 
);; 
.;; 
Select;; #
(;;# $
p;;$ %
=>;;& (
p;;) *
.;;* +
PlayerId;;+ 3
);;3 4
);;4 5
;;;5 6
new== 
Reaction== 
<== 

LeafDomain== 
,==  "
IRequireLobbyGameState==! 7
>==7 8
(==8 9
this==9 =
)=== >
.>> 
Prepare>> 
(>> 
(>> 
_>> 
,>> 
action>> 
)>>  
=>>>! #
action>>$ *
.>>* +
Game>>+ /
=>>0 1
this>>2 6
)>>6 7
.?? 
AddTo?? 
(?? 
Disposables?? 
)?? 
;??  
}@@ 
}AA 
publicCC 
classCC 
PlayerCC 
:CC 
BranchDomainCC "
{DD 
publicEE 

GuidEE 
PlayerIdEE 
{EE 
getEE 
;EE 
}EE  !
publicFF 

stringFF 
NameFF 
{FF 
getFF 
;FF 
}FF 
publicHH 

PlayerHH 
(HH 
BranchDomainHH 
parentHH %
,HH% &
GuidHH' +
playerIdHH, 4
,HH4 5
stringHH6 <
nameHH= A
)HHA B
:HHC D
baseHHE I
(HHI J
parentHHJ P
)HHP Q
{II 
PlayerIdJJ 
=JJ 
playerIdJJ 
;JJ 
NameKK 
=KK 
nameKK 
;KK 
newNN 
ReactionNN 
<NN 

LeafDomainNN 
,NN  
INetworkActionNN! /
>NN/ 0
(NN0 1
thisNN1 5
)NN5 6
.OO 
PrepareOO 
(OO 
(OO 
_OO 
,OO 
actionOO 
)OO  
=>OO! #
actionOO$ *
.OO* +

ExecutorIdOO+ 5
??=OO6 9
PlayerIdOO: B
)OOB C
.PP 
AddToPP 
(PP 
DisposablesPP 
)PP 
;PP  
}QQ 
}RR 
publicVV 
classVV 
ReadyActionVV 
:VV 
WaitForAllActionVV +
<VV+ ,
PlayerVV, 2
,VV2 3
ReadyActionVV4 ?
>VV? @
,VV@ A"
IRequireLobbyGameStateVVB X
{WW 
[XX 

JsonIgnoreXX 
]XX 
publicXX 
LobbyGameStateXX &
?XX& '
GameXX( ,
{XX- .
getXX/ 2
;XX2 3
setXX4 7
;XX7 8
}XX9 :
publicZZ 

overrideZZ 
stringZZ 
CollectiveKeyZZ (
=>ZZ) +
$strZZ, 8
;ZZ8 9
	protected\\ 
override\\ 
void\\ 
ExecuteWhenReady\\ ,
(\\, -
Player\\- 3
player\\4 :
)\\: ;
{]] 
Game^^ 
!^^ 
.^^ 
GameStarted^^ 
=^^ 
true^^  
;^^  !
Console__ 
.__ 
	WriteLine__ 
(__ 
$str__ ?
)__? @
;__@ A
}`` 
	protectedbb 
overridebb 
voidbb 
OnPlayerSubmittedbb -
(bb- .
Playerbb. 4
playerbb5 ;
)bb; <
{cc 
vardd 
(dd 
	submitteddd 
,dd 
totaldd 
)dd 
=dd  
Gamedd! %
!dd% &
.dd& '
CollectiveActionsdd' 8
.dd8 9
GetWaitForAllStatusdd9 L
(ddL M
CollectiveKeyddM Z
)ddZ [
;dd[ \
Consoleee 
.ee 
	WriteLineee 
(ee 
$"ee 
{ee 
playeree #
.ee# $
Nameee$ (
}ee( )
$stree) 4
{ee4 5
	submittedee5 >
}ee> ?
$stree? @
{ee@ A
totaleeA F
}eeF G
$streeG H
"eeH I
)eeI J
;eeJ K
}ff 
}gg 
publickk 
classkk  
VoteDifficultyActionkk !
:kk" #
VoteForActionkk$ 1
<kk1 2
Playerkk2 8
,kk8 9 
VoteDifficultyActionkk: N
>kkN O
,kkO P"
IRequireLobbyGameStatekkQ g
{ll 
[mm 

JsonIgnoremm 
]mm 
publicmm 
LobbyGameStatemm &
?mm& '
Gamemm( ,
{mm- .
getmm/ 2
;mm2 3
setmm4 7
;mm7 8
}mm9 :
publicoo 

overrideoo 
stringoo 
CollectiveKeyoo (
=>oo) +
$stroo, <
;oo< =
publicpp 

overridepp 
stringpp 

VoteOptionpp %
=>pp& (

Difficultypp) 3
;pp3 4
publicrr 

stringrr 

Difficultyrr 
{rr 
getrr "
;rr" #
setrr$ '
;rr' (
}rr) *
=rr+ ,
$strrr- 5
;rr5 6
	protectedtt 
overridett 
voidtt 
ExecuteWhenWontt *
(tt* +
Playertt+ 1
playertt2 8
)tt8 9
{uu 
Gamevv 
!vv 
.vv 
SelectedDifficultyvv  
=vv! "

Difficultyvv# -
;vv- .
Consoleww 
.ww 
	WriteLineww 
(ww 
$"ww 
$strww 1
{ww1 2

Difficultyww2 <
}ww< =
$strww= F
{wwF G
stringwwG M
.wwM N
JoinwwN R
(wwR S
$strwwS W
,wwW X
FinalVoteCountswwY h
!wwh i
.wwi j
Selectwwj p
(wwp q
kvwwq s
=>wwt v
$"www y
{wwy z
kvwwz |
.ww| }
Key	ww} Ä
}
wwÄ Å
$str
wwÅ Ç
{
wwÇ É
kv
wwÉ Ö
.
wwÖ Ü
Value
wwÜ ã
}
wwã å
"
wwå ç
)
wwç é
)
wwé è
}
wwè ê
$str
wwê ë
"
wwë í
)
wwí ì
;
wwì î
}xx 
	protectedzz 
overridezz 
voidzz 
OnVoteSubmittedzz +
(zz+ ,
Playerzz, 2
playerzz3 9
)zz9 :
{{{ 
Console|| 
.|| 
	WriteLine|| 
(|| 
$"|| 
{|| 
player|| #
.||# $
Name||$ (
}||( )
$str||) 4
{||4 5

Difficulty||5 ?
}||? @
"||@ A
)||A B
;||B C
}}} 
}~~ ä=
ô/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/GettingStarted/Example05_NetworkActions.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
.. /
GettingStarted/ =
;= >
public

 
static

 
class

 $
Example05_NetworkActions

 ,
{ 
public 

static 
void 
Run 
( 
) 
{ 
var 
server 
= 
new 

GameServer #
(# $
)$ %
;% &
var 
clientA 
= 
new 

GameClient $
($ %
$str% ,
), -
;- .
var 
clientB 
= 
new 

GameClient $
($ %
$str% *
)* +
;+ ,
var 

actionJson 
= 
clientA  
.  !
CreateMoveAction! 1
(1 2
x2 3
:3 4
$num5 7
,7 8
y9 :
:: ;
$num< >
)> ?
;? @
Console 
. 
	WriteLine 
( 
$" 
$str ,
{, -

actionJson- 7
}7 8
"8 9
)9 :
;: ;
server 
. 
ReceiveAction 
( 

actionJson '
,' (
broadcastTo) 4
:4 5
[6 7
clientA7 >
,> ?
clientB@ G
]G H
)H I
;I J
Console 
. 
	WriteLine 
( 
$" 
$str 5
{5 6
server6 <
.< =
PlayerX= D
}D E
$strE G
{G H
serverH N
.N O
PlayerYO V
}V W
$strW X
"X Y
)Y Z
;Z [
Console 
. 
	WriteLine 
( 
$" 
$str 7
{7 8
clientA8 ?
.? @
PlayerX@ G
}G H
$strH J
{J K
clientAK R
.R S
PlayerYS Z
}Z [
$str[ \
"\ ]
)] ^
;^ _
Console 
. 
	WriteLine 
( 
$" 
$str 7
{7 8
clientB8 ?
.? @
PlayerX@ G
}G H
$strH J
{J K
clientBK R
.R S
PlayerYS Z
}Z [
$str[ \
"\ ]
)] ^
;^ _
}   
}!! 
public%% 
class%% 

GameServer%% 
{&& 
private'' 
readonly'' 

RootDomain'' 
_root''  %
=''& '
new''( +
(''+ ,
)'', -
;''- .
public(( 

int(( 
PlayerX(( 
{(( 
get(( 
;(( 
private(( %
set((& )
;(() *
}((+ ,
public)) 

int)) 
PlayerY)) 
{)) 
get)) 
;)) 
private)) %
set))& )
;))) *
}))+ ,
public++ 

void++ 
ReceiveAction++ 
(++ 
string++ $
json++% )
,++) *

GameClient+++ 5
[++5 6
]++6 7
broadcastTo++8 C
)++C D
{,, 
var-- 
action-- 
=-- 
JsonConvert--  
.--  !
DeserializeObject--! 2
<--2 3

MoveAction--3 =
>--= >
(--> ?
json--? C
)--C D
!--D E
;--E F
if00 

(00 
action00 
.00 
X00 
<00 
$num00 
||00 
action00 "
.00" #
Y00# $
<00% &
$num00' (
)00( )
{11 	
Console22 
.22 
	WriteLine22 
(22 
$str22 ?
)22? @
;22@ A
return33 
;33 
}44 	
PlayerX77 
=77 
action77 
.77 
X77 
;77 
PlayerY88 
=88 
action88 
.88 
Y88 
;88 
Console99 
.99 
	WriteLine99 
(99 
$"99 
$str99 6
{996 7
action997 =
.99= >
X99> ?
}99? @
$str99@ B
{99B C
action99C I
.99I J
Y99J K
}99K L
$str99L M
"99M N
)99N O
;99O P
foreach<< 
(<< 
var<< 
client<< 
in<< 
broadcastTo<< *
)<<* +
client== 
.== 
ReceiveAction==  
(==  !
json==! %
)==% &
;==& '
}>> 
}?? 
publicCC 
classCC 

GameClientCC 
{DD 
publicEE 

stringEE 
NameEE 
{EE 
getEE 
;EE 
}EE 
publicFF 

intFF 
PlayerXFF 
{FF 
getFF 
;FF 
privateFF %
setFF& )
;FF) *
}FF+ ,
publicGG 

intGG 
PlayerYGG 
{GG 
getGG 
;GG 
privateGG %
setGG& )
;GG) *
}GG+ ,
publicII 


GameClientII 
(II 
stringII 
nameII !
)II! "
=>II# %
NameII& *
=II+ ,
nameII- 1
;II1 2
publicKK 

stringKK 
CreateMoveActionKK "
(KK" #
intKK# &
xKK' (
,KK( )
intKK* -
yKK. /
)KK/ 0
{LL 
returnMM 
JsonConvertMM 
.MM 
SerializeObjectMM *
(MM* +
newMM+ .

MoveActionMM/ 9
{MM: ;
XMM< =
=MM> ?
xMM@ A
,MMA B
YMMC D
=MME F
yMMG H
}MMI J
)MMJ K
;MMK L
}NN 
publicPP 

voidPP 
ReceiveActionPP 
(PP 
stringPP $
jsonPP% )
)PP) *
{QQ 
varRR 
actionRR 
=RR 
JsonConvertRR  
.RR  !
DeserializeObjectRR! 2
<RR2 3

MoveActionRR3 =
>RR= >
(RR> ?
jsonRR? C
)RRC D
!RRD E
;RRE F
PlayerXSS 
=SS 
actionSS 
.SS 
XSS 
;SS 
PlayerYTT 
=TT 
actionTT 
.TT 
YTT 
;TT 
ConsoleUU 
.UU 
	WriteLineUU 
(UU 
$"UU 
$strUU #
{UU# $
NameUU$ (
}UU( )
$strUU) D
"UUD E
)UUE F
;UUF G
}VV 
}WW 
public[[ 
class[[ 

MoveAction[[ 
{\\ 
[]] 
JsonProperty]] 
]]] 
public]] 
int]] 
X]] 
{]]  !
get]]" %
;]]% &
set]]' *
;]]* +
}]], -
[^^ 
JsonProperty^^ 
]^^ 
public^^ 
int^^ 
Y^^ 
{^^  !
get^^" %
;^^% &
set^^' *
;^^* +
}^^, -
}__ ¨,
ü/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/GettingStarted/Example04_ObservableAttributes.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
.. /
GettingStarted/ =
;= >
public 
static 
class *
Example04_ObservableAttributes 2
{ 
public 

static 
void 
Run 
( 
) 
{ 
var 
game 
= 
new 
Game04Domain #
(# $
)$ %
;% &
var 
player 
= 
new 
Player04Domain '
(' (
game( ,
,, -
$str. 4
)4 5
;5 6
var 
	healthBar 
= 
new 
HealthBarUI '
(' (
player( .
). /
;/ 0
Console 
. 
	WriteLine 
( 
$str 4
)4 5
;5 6
Console 
. 
	WriteLine 
( 
) 
; 
Console 
. 
	WriteLine 
( 
$str /
)/ 0
;0 1
player 
. 
Health 
. 
Value 
-= 
$num !
;! "
Console 
. 
	WriteLine 
( 
$str 6
)6 7
;7 8
player   
.   
Health   
.   
Value   
-=   
$num   !
;  ! "
Console"" 
."" 
	WriteLine"" 
("" 
$str"" .
)"". /
;""/ 0
player## 
.## 
Health## 
.## 
Value## 
+=## 
$num## !
;##! "
game%% 
.%% 
Dispose%% 
(%% 
)%% 
;%% 
}&& 
}'' 
public++ 
class++ 
Game04Domain++ 
:++ 
BranchDomain++ (
{,, 
public-- 

Game04Domain-- 
(-- 
)-- 
:-- 
base--  
(--  !
null--! %
)--% &
{--' (
}--) *
}.. 
public00 
class00 
Player04Domain00 
:00 
BranchDomain00 *
{11 
public22 

string22 
Name22 
{22 
get22 
;22 
}22 
public55 

ObservableAttribute55 
<55 
int55 "
>55" #
Health55$ *
{55+ ,
get55- 0
;550 1
}552 3
=554 5
new556 9
(559 :
$num55: =
)55= >
;55> ?
public77 

Player04Domain77 
(77 
BranchDomain77 &
parent77' -
,77- .
string77/ 5
name776 :
)77: ;
:77< =
base77> B
(77B C
parent77C I
)77I J
{88 
Name99 
=99 
name99 
;99 
}:: 
};; 
public@@ 
class@@ 
HealthBarUI@@ 
:@@ 

LeafDomain@@ %
{AA 
publicBB 

HealthBarUIBB 
(BB 
Player04DomainBB %
playerBB& ,
)BB, -
:BB. /
baseBB0 4
(BB4 5
playerBB5 ;
)BB; <
{CC 
playerEE 
.EE 
HealthEE 
.EE 
ObserveEE 
(EE 
thisEE "
,EE" #
healthEE$ *
=>EE+ -
{FF 	
varGG 
	barLengthGG 
=GG 
$numGG 
;GG 
varHH 
filledHH 
=HH 
(HH 
intHH 
)HH 
(HH 
(HH  
healthHH  &
/HH' (
$numHH) .
)HH. /
*HH0 1
	barLengthHH2 ;
)HH; <
;HH< =
varII 
barII 
=II 
newII 
stringII  
(II  !
$charII! $
,II$ %
filledII& ,
)II, -
+II. /
newII0 3
stringII4 :
(II: ;
$charII; >
,II> ?
	barLengthII@ I
-IIJ K
filledIIL R
)IIR S
;IIS T
varKK 
colorKK 
=KK 
healthKK 
switchKK %
{LL 
<=MM 
$numMM 
=>MM 
$strMM 
,MM 
<=NN 
$numNN 
=>NN 
$strNN !
,NN! "
_OO 
=>OO 
$strOO 
}PP 
;PP 
ConsoleRR 
.RR 
	WriteLineRR 
(RR 
$"RR  
$strRR  (
{RR( )
barRR) ,
}RR, -
$strRR- /
{RR/ 0
healthRR0 6
}RR6 7
$strRR7 @
{RR@ A
colorRRA F
}RRF G
$strRRG H
"RRH I
)RRI J
;RRJ K
ifTT 
(TT 
healthTT 
<=TT 
$numTT 
)TT 
ConsoleUU 
.UU 
	WriteLineUU !
(UU! "
$"UU" $
$strUU$ B
"UUB C
)UUC D
;UUD E
}VV 	
)VV	 

;VV
 
}WW 
}XX ≠+
ö/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/GettingStarted/Example03_DomainHierarchy.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
.. /
GettingStarted/ =
;= >
public		 
static		 
class		 %
Example03_DomainHierarchy		 -
{

 
public 

static 
void 
Run 
( 
) 
{ 
var 
root 
= 
new 

RootDomain !
(! "
)" #
;# $
var 
player 
= 
new 
PlayerDomain %
(% &
root& *
,* +
$str, 2
)2 3
;3 4
new 

ItemDomain 
( 
player 
. 
	Inventory '
,' (
$str) 0
)0 1
{2 3
Value4 9
=: ;
$num< >
}? @
;@ A
new 

ItemDomain 
( 
player 
. 
	Inventory '
,' (
$str) 1
)1 2
{3 4
Value5 :
=; <
$num= ?
}@ A
;A B
var 
	firstItem 
= 
player 
. 
	Inventory (
.( )
Items) .
.. /
First/ 4
(4 5
)5 6
;6 7
var 
owner 
= 
	firstItem 
. 
GetInParent )
<) *
PlayerDomain* 6
>6 7
(7 8
)8 9
;9 :
Console 
. 
	WriteLine 
( 
$" 
$str 
{ 
	firstItem '
.' (
Name( ,
}, -
$str- ;
{; <
owner< A
?A B
.B C
NameC G
}G H
"H I
)I J
;J K
var 
allItems 
= 
root 
. 
GetAll "
<" #

ItemDomain# -
>- .
(. /
)/ 0
;0 1
Console 
. 
	WriteLine 
( 
$" 
$str )
{) *
allItems* 2
.2 3
Count3 8
}8 9
"9 :
): ;
;; <
	firstItem 
. 
Dispose 
( 
) 
; 
Console 
. 
	WriteLine 
( 
$" 
$str 1
{1 2
player2 8
.8 9
	Inventory9 B
.B C
ItemsC H
.H I
CountI N
(N O
)O P
}P Q
"Q R
)R S
;S T
root!! 
.!! 
Dispose!! 
(!! 
)!! 
;!! 
}"" 
}## 
public'' 
class'' 
PlayerDomain'' 
:'' 
BranchDomain'' (
{(( 
public)) 

string)) 
Name)) 
{)) 
get)) 
;)) 
set)) !
;))! "
}))# $
public** 

InventoryDomain** 
	Inventory** $
{**% &
get**' *
;*** +
}**, -
public,, 

PlayerDomain,, 
(,, 
BranchDomain,, $
parent,,% +
,,,+ ,
string,,- 3
name,,4 8
),,8 9
:,,: ;
base,,< @
(,,@ A
parent,,A G
),,G H
{-- 
Name.. 
=.. 
name.. 
;.. 
	Inventory// 
=// 
new// 
InventoryDomain// '
(//' (
this//( ,
)//, -
;//- .
}00 
}11 
public33 
class33 
InventoryDomain33 
:33 
BranchDomain33 +
{44 
public55 

InventoryDomain55 
(55 
BranchDomain55 '
parent55( .
)55. /
:550 1
base552 6
(556 7
parent557 =
)55= >
{55? @
}55A B
public77 

IEnumerable77 
<77 

ItemDomain77 !
>77! "
Items77# (
=>77) +
GetAll77, 2
<772 3

ItemDomain773 =
>77= >
(77> ?
)77? @
;77@ A
}88 
public:: 
class:: 

ItemDomain:: 
::: 
BranchDomain:: &
{;; 
public<< 

string<< 
Name<< 
{<< 
get<< 
;<< 
set<< !
;<<! "
}<<# $
public== 

int== 
Value== 
{== 
get== 
;== 
set== 
;==  
}==! "
public?? 


ItemDomain?? 
(?? 
BranchDomain?? "
parent??# )
,??) *
string??+ 1
name??2 6
)??6 7
:??8 9
base??: >
(??> ?
parent??? E
)??E F
{@@ 
NameAA 
=AA 
nameAA 
;AA 
}BB 
}CC Ü 
î/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/GettingStarted/Example02_Reactions.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
.. /
GettingStarted/ =
;= >
public

 
static

 
class

 
Example02_Reactions

 '
{ 
public 

static 
void 
Run 
( 
) 
{ 
var 
root 
= 
new 

RootDomain !
(! "
)" #
;# $
var 

idProvider 
= 
new 
SimpleIdProvider -
(- .
root. 2
)2 3
;3 4
var 
alice 
= 
new 
ActorDomain #
(# $
root$ (
,( )
$str* 1
)1 2
;2 3
var 
bob 
= 
new 
ActorDomain !
(! "
root" &
,& '
$str( -
)- .
;. /
Console 
. 
	WriteLine 
( 
$" 
$str 
{ 
alice #
.# $
Name$ (
}( )
$str) 3
{3 4
alice4 9
.9 :
Id: <
}< =
"= >
)> ?
;? @
Console 
. 
	WriteLine 
( 
$" 
$str 
{ 
bob !
.! "
Name" &
}& '
$str' 1
{1 2
bob2 5
.5 6
Id6 8
}8 9
"9 :
): ;
;; <
Console 
. 
	WriteLine 
( 
$" 
$str 0
{0 1

idProvider1 ;
.; <
CurrentCounter< J
-K L
$numM N
}N O
"O P
)P Q
;Q R
root 
. 
Dispose 
( 
) 
; 
} 
} 
public   
class   
ActorDomain   
:   
BranchDomain   '
{!! 
public"" 

string"" 
Name"" 
{"" 
get"" 
;"" 
}"" 
public$$ 

ActorDomain$$ 
($$ 
BranchDomain$$ #
parent$$$ *
,$$* +
string$$, 2
name$$3 7
)$$7 8
:$$9 :
base$$; ?
($$? @
parent$$@ F
)$$F G
{%% 
Name&& 
=&& 
name&& 
;&& 
}'' 
}(( 
public-- 
class-- 
SimpleIdProvider-- 
:-- 
BranchDomain--  ,
{.. 
private// 
int// 
_counter// 
=// 
$num// 
;// 
public11 

int11 
CurrentCounter11 
=>11  
_counter11! )
;11) *
public33 

SimpleIdProvider33 
(33 
BranchDomain33 (
target33) /
)33/ 0
:331 2
base333 7
(337 8
target338 >
)33> ?
{44 
new66 
Reaction66 
<66 

LeafDomain66 
,66  
AddSubdomainAction66! 3
>663 4
(664 5
target665 ;
)66; <
.77 
After77 
(77 
(77 
_77 
,77 
action77 
)77 
=>77 !
action77" (
.77( )
Child77) .
.77. /
Id77/ 1
=772 3
_counter774 <
++77< >
)77> ?
.88 
AddTo88 
(88 
Disposables88 
)88 
;88  
}99 
}:: à
ï/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/GettingStarted/Example01_HelloWorld.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
.. /
GettingStarted/ =
;= >
public		 
static		 
class		  
Example01_HelloWorld		 (
{

 
public 

static 
void 
Run 
( 
) 
{ 
var 
root 
= 
new 

RootDomain !
(! "
)" #
;# $
var 
counter 
= 
new 
CounterDomain '
(' (
root( ,
), -
;- .
new 
IncrementAction 
{ 
Amount $
=% &
$num' (
}) *
.* +
Execute+ 2
(2 3
counter3 :
): ;
;; <
new 
IncrementAction 
{ 
Amount $
=% &
$num' (
}) *
.* +
Execute+ 2
(2 3
counter3 :
): ;
;; <
new 
IncrementAction 
{ 
Amount $
=% &
$num' )
}* +
.+ ,
Execute, 3
(3 4
counter4 ;
); <
;< =
Console 
. 
	WriteLine 
( 
$" 
$str )
{) *
counter* 1
.1 2
Value2 7
}7 8
"8 9
)9 :
;: ;
root 
. 
Dispose 
( 
) 
; 
} 
} 
public   
class   
CounterDomain   
:   

LeafDomain   '
{!! 
public"" 

int"" 
Value"" 
{"" 
get"" 
;"" 
private"" #
set""$ '
;""' (
}"") *
=""+ ,
$num""- .
;"". /
public$$ 

CounterDomain$$ 
($$ 
BranchDomain$$ %
parent$$& ,
)$$, -
:$$. /
base$$0 4
($$4 5
parent$$5 ;
)$$; <
{$$= >
}$$? @
public&& 

void&& 
	Increment&& 
(&& 
int&& 
amount&& $
)&&$ %
=>&&& (
Value&&) .
+=&&/ 1
amount&&2 8
;&&8 9
}'' 
public++ 
class++ 
IncrementAction++ 
:++ 
	DARAction++ (
<++( )
CounterDomain++) 6
,++6 7
IncrementAction++8 G
>++G H
{,, 
public-- 

int-- 
Amount-- 
{-- 
get-- 
;-- 
set--  
;--  !
}--" #
=--$ %
$num--& '
;--' (
	protected// 
override// 
void// 
ExecuteProcess// *
(//* +
CounterDomain//+ 8
domain//9 ?
)//? @
{00 
domain11 
.11 
	Increment11 
(11 
Amount11 
)11  
;11  !
}22 
}33 •=
§/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/DetermenismValidation/DeterminismValidation_Simple.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
;. /
public

 
class

 (
DeterminismValidation_Simple

 )
{ 
public 

static 
void 
Example 
( 
)  
{ 
Console 
. 
	WriteLine 
( 
$str K
)K L
;L M 
DeterminismValidator 
< 
MyGameState (
>( )
.) *
	IsEnabled* 3
=4 5
true6 :
;: ;
Console 
. 
	WriteLine 
( 
$str <
)< =
;= >
var 
serverDomain 
= 
new 
ServerDomain +
(+ ,
), -
;- .
var 
gameStateFactory 
= 
new "
MyGameStateFactory# 5
(5 6
)6 7
;7 8
var 
matchManager 
= 
new 
MatchManager +
<+ ,
MyGameState, 7
>7 8
(8 9
serverDomain9 E
,E F
gameStateFactoryG W
)W X
;X Y
var 
validatingManager 
= 
new  #-
!DeterminismValidatingMatchManager$ E
<E F
MyGameStateF Q
>Q R
(R S
matchManager 
, 
gameStateFactory 
) 	
;	 

Console 
. 
	WriteLine 
( 
$str >
)> ?
;? @
var!! 
matchId!! 
=!! 
Guid!! 
.!! 
NewGuid!! "
(!!" #
)!!# $
;!!$ %
var"" 
	player1Id"" 
="" 
Guid"" 
."" 
NewGuid"" $
(""$ %
)""% &
;""& '
var## 
	player2Id## 
=## 
Guid## 
.## 
NewGuid## $
(##$ %
)##% &
;##& '
var%% 
	gameState%% 
=%% 
matchManager%% $
.%%$ %
CreateMatch%%% 0
(%%0 1
matchId%%1 8
)%%8 9
;%%9 :
Console&& 
.&& 
	WriteLine&& 
(&& 
$"&& 
$str&& -
{&&- .
matchId&&. 5
}&&5 6
"&&6 7
)&&7 8
;&&8 9
Console'' 
.'' 
	WriteLine'' 
('' 
$"'' 
$str'' 0
{''0 1
validatingManager''1 B
.''B C
GetValidator''C O
(''O P
matchId''P W
)''W X
!=''Y [
null''\ `
}''` a
"''a b
)''b c
;''c d
var** 
executor** 
=** 
new** !
NetworkActionExecutor** 0
(**0 1
	gameState**1 :
.**: ;
Registry**; C
)**C D
;**D E
validatingManager-- 
.-- !
InstallValidationHook-- /
(--/ 0
matchId--0 7
,--7 8
executor--9 A
)--A B
;--B C
Console.. 
... 
	WriteLine.. 
(.. 
$str.. C
)..C D
;..D E
Console11 
.11 
	WriteLine11 
(11 
$str11 2
)112 3
;113 4
var33 
action133 
=33 
new33 
MyTestAction33 &
{33' (
DomainId33) 1
=332 3
$num334 5
,335 6

ExecutorId337 A
=33B C
	player1Id33D M
}33N O
;33O P
executor44 
.44 
ExecuteAction44 
(44 
action144 &
,44& '
	player1Id44( 1
)441 2
;442 3
Console55 
.55 
	WriteLine55 
(55 
$str55 E
)55E F
;55F G
var77 
action277 
=77 
new77 
MyTestAction77 &
{77' (
DomainId77) 1
=772 3
$num774 5
,775 6

ExecutorId777 A
=77B C
	player2Id77D M
}77N O
;77O P
executor88 
.88 
ExecuteAction88 
(88 
action288 &
,88& '
	player2Id88( 1
)881 2
;882 3
Console99 
.99 
	WriteLine99 
(99 
$str99 E
)99E F
;99F G
var<< 
	validator<< 
=<< 
validatingManager<< )
.<<) *
GetValidator<<* 6
(<<6 7
matchId<<7 >
)<<> ?
;<<? @
if== 

(== 
	validator== 
!=== 
null== 
)== 
{>> 	
Console?? 
.?? 
	WriteLine?? 
(?? 
$"??  
$str??  7
"??7 8
)??8 9
;??9 :
Console@@ 
.@@ 
	WriteLine@@ 
(@@ 
$"@@  
$str@@  5
{@@5 6
	validator@@6 ?
.@@? @
ActionCount@@@ K
}@@K L
"@@L M
)@@M N
;@@N O
ConsoleAA 
.AA 
	WriteLineAA 
(AA 
$"AA  
$strAA  .
{AA. /
	validatorAA/ 8
.AA8 9
	HasFailedAA9 B
}AAB C
"AAC D
)AAD E
;AAE F
}BB 	
validatingManagerEE 
.EE 
OnMatchRemovedEE (
(EE( )
matchIdEE) 0
)EE0 1
;EE1 2
matchManagerFF 
.FF 
RemoveMatchFF  
(FF  !
matchIdFF! (
)FF( )
;FF) *
ConsoleGG 
.GG 
	WriteLineGG 
(GG 
$strGG >
)GG> ?
;GG? @
}HH 
}II 
publicLL 
classLL 
MyGameStateLL 
:LL 
NetworkGameStateLL +
{MM 
publicNN 

MyGameStateNN 
(NN 
GuidNN 
matchIdNN #
)NN# $
:NN% &
baseNN' +
(NN+ ,
matchIdNN, 3
,NN3 4
matchIdNN5 <
.NN< =
GetHashCodeNN= H
(NNH I
)NNI J
)NNJ K
{NNL M
}NNN O
}OO 
publicQQ 
classQQ 
MyGameStateFactoryQQ 
:QQ  !
IGameStateFactoryQQ" 3
<QQ3 4
MyGameStateQQ4 ?
>QQ? @
{RR 
publicSS 

MyGameStateSS 
CreateGameStateSS &
(SS& '
GuidSS' +
matchIdSS, 3
)SS3 4
=>SS5 7
newSS8 ;
MyGameStateSS< G
(SSG H
matchIdSSH O
)SSO P
;SSP Q
}TT 
publicVV 
classVV 
MyTestActionVV 
:VV 
NetworkActionVV )
<VV) *
MyGameStateVV* 5
,VV5 6
MyTestActionVV7 C
>VVC D
{WW 
	protectedXX 
overrideXX 
voidXX 
ExecuteProcessXX *
(XX* +
MyGameStateXX+ 6
domainXX7 =
)XX= >
{YY 
ConsoleZZ 
.ZZ 
	WriteLineZZ 
(ZZ 
$"ZZ 
$strZZ ;
{ZZ; <

ExecutorIdZZ< F
}ZZF G
"ZZG H
)ZZH I
;ZZI J
}[[ 
}\\ Æè
™/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/DetermenismValidation/DeterminismValidation_Reconnection.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
;. /
public 
class .
"DeterminismValidation_Reconnection /
{ 
public 

static 
void 
Example 
( 
)  
{ 
Console 
. 
	WriteLine 
( 
$str \
)\ ]
;] ^
Console 
. 
	WriteLine 
( 
$str \
)\ ]
;] ^
Console 
. 
	WriteLine 
( 
$str ^
)^ _
;_ `
Console 
. 
	WriteLine 
( 
$str 6
)6 7
;7 8
Console 
. 
	WriteLine 
( 
$str Q
)Q R
;R S
Console 
. 
	WriteLine 
( 
$str @
)@ A
;A B
Console 
. 
	WriteLine 
( 
$str J
)J K
;K L
Console 
. 
	WriteLine 
( 
$str O
)O P
;P Q
var 
	stopwatch 
= 
	Stopwatch !
.! "
StartNew" *
(* +
)+ ,
;, -
Console   
.   
	WriteLine   
(   
$str   Y
)  Y Z
;  Z [
Console!! 
.!! 
	WriteLine!! 
(!! 
$str!! B
)!!B C
;!!C D
Console"" 
."" 
	WriteLine"" 
("" 
$str"" Y
)""Y Z
;""Z [
var$$ 
matchId$$ 
=$$ 
Guid$$ 
.$$ 
NewGuid$$ "
($$" #
)$$# $
;$$$ %
var%% 
	player1Id%% 
=%% 
Guid%% 
.%% 
NewGuid%% $
(%%$ %
)%%% &
;%%& '
var&& 
	player2Id&& 
=&& 
Guid&& 
.&& 
NewGuid&& $
(&&$ %
)&&% &
;&&& '
var)) 
serverState)) 
=)) 
new)) !
ReconnectionGameState)) 3
())3 4
matchId))4 ;
))); <
;))< =
var** 
serverExecutor** 
=** 
new**  !
NetworkActionExecutor**! 6
(**6 7
serverState**7 B
.**B C
Registry**C K
)**K L
;**L M
Console,, 
.,, 
	WriteLine,, 
(,, 
$",, 
$str,, ;
{,,; <
matchId,,< C
},,C D
$str,,D E
",,E F
),,F G
;,,G H
Console-- 
.-- 
	WriteLine-- 
(-- 
$"-- 
$str-- ,
{--, -
serverState--- 8
.--8 9 
RandomProviderDomain--9 M
.--M N
Seed--N R
}--R S
"--S T
)--T U
;--U V
Console.. 
... 
	WriteLine.. 
(.. 
$".. 
$str.. /
{../ 0
serverState..0 ;
...; <
Counter..< C
...C D
Value..D I
}..I J
"..J K
)..K L
;..L M
Console// 
.// 
	WriteLine// 
(// 
$"// 
$str// -
{//- .
serverState//. 9
.//9 :
Score//: ?
.//? @
Value//@ E
}//E F
$str//F H
"//H I
)//I J
;//J K
var22 
actionCount22 
=22 
$num22 
;22 
var33 
random33 
=33 
new33 
Random33 
(33  
$num33  "
)33" #
;33# $
Console55 
.55 
	WriteLine55 
(55 
$"55 
$str55 &
{55& '
actionCount55' 2
}552 3
$str553 H
"55H I
)55I J
;55J K
for66 
(66 
int66 
i66 
=66 
$num66 
;66 
i66 
<66 
actionCount66 '
;66' (
i66) *
++66* ,
)66, -
{77 	
var88 
playerId88 
=88 
random88 !
.88! "
Next88" &
(88& '
$num88' (
)88( )
==88* ,
$num88- .
?88/ 0
	player1Id881 :
:88; <
	player2Id88= F
;88F G
var99 

actionType99 
=99 
random99 #
.99# $
Next99$ (
(99( )
$num99) *
)99* +
;99+ ,
INetworkAction;; 
action;; !
=;;" #

actionType;;$ .
switch;;/ 5
{<< 
$num== 
=>== 
new== "
IncrementCounterAction== /
{==0 1
DomainId==2 :
===; <
$num=== >
,==> ?

ExecutorId==@ J
===K L
playerId==M U
}==V W
,==W X
$num>> 
=>>> 
new>> 
AddScoreAction>> '
{>>( )
DomainId>>* 2
=>>3 4
$num>>5 6
,>>6 7

ExecutorId>>8 B
=>>C D
playerId>>E M
,>>M N
Points>>O U
=>>V W
random>>X ^
.>>^ _
Next>>_ c
(>>c d
$num>>d e
,>>e f
$num>>g i
)>>i j
}>>k l
,>>l m
_?? 
=>?? 
new?? 
RandomEventAction?? *
{??+ ,
DomainId??- 5
=??6 7
$num??8 9
,??9 :

ExecutorId??; E
=??F G
playerId??H P
}??Q R
}@@ 
;@@ 
serverExecutorBB 
.BB 
ExecuteActionBB (
(BB( )
actionBB) /
,BB/ 0
playerIdBB1 9
)BB9 :
;BB: ;
ifDD 
(DD 
(DD 
iDD 
+DD 
$numDD 
)DD 
%DD 
$numDD 
==DD 
$numDD  
)DD  !
{EE 
ConsoleFF 
.FF 
	WriteLineFF !
(FF! "
$"FF" $
$strFF$ 0
{FF0 1
iFF1 2
+FF3 4
$numFF5 6
}FF6 7
$strFF7 8
{FF8 9
actionCountFF9 D
}FFD E
$strFFE M
"FFM N
)FFN O
;FFO P
}GG 
}HH 	
ConsoleJJ 
.JJ 
	WriteLineJJ 
(JJ 
$"JJ 
$strJJ 0
{JJ0 1
actionCountJJ1 <
}JJ< =
$strJJ= E
"JJE F
)JJF G
;JJG H
ConsoleKK 
.KK 
	WriteLineKK 
(KK 
$"KK 
$strKK -
{KK- .
serverStateKK. 9
.KK9 :
CounterKK: A
.KKA B
ValueKKB G
}KKG H
"KKH I
)KKI J
;KKJ K
ConsoleLL 
.LL 
	WriteLineLL 
(LL 
$"LL 
$strLL +
{LL+ ,
serverStateLL, 7
.LL7 8
ScoreLL8 =
.LL= >
ValueLL> C
}LLC D
"LLD E
)LLE F
;LLF G
ConsoleMM 
.MM 
	WriteLineMM 
(MM 
$"MM 
$strMM ,
{MM, -
serverStateMM- 8
.MM8 9
HistoryMM9 @
.MM@ A
CountMMA F
}MMF G
$strMMG Q
"MMQ R
)MMR S
;MMS T
ConsoleRR 
.RR 
	WriteLineRR 
(RR 
$strRR Y
)RRY Z
;RRZ [
ConsoleSS 
.SS 
	WriteLineSS 
(SS 
$strSS N
)SSN O
;SSO P
ConsoleTT 
.TT 
	WriteLineTT 
(TT 
$strTT Y
)TTY Z
;TTZ [
varWW 
clientStateWW 
=WW 
newWW !
ReconnectionGameStateWW 3
(WW3 4
matchIdWW4 ;
)WW; <
;WW< =
varXX 
clientExecutorXX 
=XX 
newXX  !
NetworkActionExecutorXX! 6
(XX6 7
clientStateXX7 B
.XXB C
RegistryXXC K
)XXK L
;XXL M
ConsoleZZ 
.ZZ 
	WriteLineZZ 
(ZZ 
$"ZZ 
$strZZ C
"ZZC D
)ZZD E
;ZZE F
Console[[ 
.[[ 
	WriteLine[[ 
([[ 
$"[[ 
$str[[ ,
{[[, -
clientState[[- 8
.[[8 9 
RandomProviderDomain[[9 M
.[[M N
Seed[[N R
}[[R S
"[[S T
)[[T U
;[[U V
Console\\ 
.\\ 
	WriteLine\\ 
(\\ 
$"\\ 
$str\\ /
{\\/ 0
clientState\\0 ;
.\\; <
Counter\\< C
.\\C D
Value\\D I
}\\I J
"\\J K
)\\K L
;\\L M
Console]] 
.]] 
	WriteLine]] 
(]] 
$"]] 
$str]] -
{]]- .
clientState]]. 9
.]]9 :
Score]]: ?
.]]? @
Value]]@ E
}]]E F
$str]]F H
"]]H I
)]]I J
;]]J K
Console`` 
.`` 
	WriteLine`` 
(`` 
$"`` 
$str`` &
{``& '
serverState``' 2
.``2 3
History``3 :
.``: ;
Count``; @
}``@ A
$str``A Y
"``Y Z
)``Z [
;``[ \
varbb 
replayStopwatchbb 
=bb 
	Stopwatchbb '
.bb' (
StartNewbb( 0
(bb0 1
)bb1 2
;bb2 3
foreachcc 
(cc 
varcc 
actioncc 
incc 
serverStatecc *
.cc* +
Historycc+ 2
)cc2 3
{dd 	
varff 

actionJsonff 
=ff 
JsonSerializerff +
.ff+ ,
ToJsonff, 2
(ff2 3
actionff3 9
)ff9 :
;ff: ;
vargg 
clonedActiongg 
=gg 
JsonSerializergg -
.gg- .
FromJsongg. 6
<gg6 7
INetworkActiongg7 E
>ggE F
(ggF G

actionJsonggG Q
)ggQ R
;ggR S
clientExecutorii 
.ii 
ExecuteActionii (
(ii( )
clonedActionii) 5
,ii5 6
clonedActionii7 C
.iiC D

ExecutorIdiiD N
)iiN O
;iiO P
}jj 	
replayStopwatchkk 
.kk 
Stopkk 
(kk 
)kk 
;kk 
Consolemm 
.mm 
	WriteLinemm 
(mm 
$"mm 
$strmm 2
{mm2 3
serverStatemm3 >
.mm> ?
Historymm? F
.mmF G
CountmmG L
}mmL M
$strmmM U
"mmU V
)mmV W
;mmW X
Consolenn 
.nn 
	WriteLinenn 
(nn 
$"nn 
$strnn +
{nn+ ,
replayStopwatchnn, ;
.nn; <
ElapsedMillisecondsnn< O
}nnO P
$strnnP S
"nnS T
)nnT U
;nnU V
Consoleoo 
.oo 
	WriteLineoo 
(oo 
$"oo 
$stroo .
{oo. /
(oo/ 0
doubleoo0 6
)oo6 7
replayStopwatchoo7 F
.ooF G
ElapsedMillisecondsooG Z
/oo[ \
serverStateoo] h
.ooh i
Historyooi p
.oop q
Countooq v
:oov w
$stroow y
}ooy z
$strooz 
"	oo Ä
)
ooÄ Å
;
ooÅ Ç
Consolett 
.tt 
	WriteLinett 
(tt 
$strtt Y
)ttY Z
;ttZ [
Consoleuu 
.uu 
	WriteLineuu 
(uu 
$struu T
)uuT U
;uuU V
Consolevv 
.vv 
	WriteLinevv 
(vv 
$strvv Y
)vvY Z
;vvZ [ 
DeterminismValidatoryy 
<yy !
ReconnectionGameStateyy 2
>yy2 3
.yy3 4
	IsEnabledyy4 =
=yy> ?
trueyy@ D
;yyD E 
DeterminismValidatorzz 
<zz !
ReconnectionGameStatezz 2
>zz2 3
.zz3 4
SkipStateValidationzz4 G
=zzH I
falsezzJ O
;zzO P 
DeterminismValidator{{ 
<{{ !
ReconnectionGameState{{ 2
>{{2 3
.{{3 4"
UseFastStateComparison{{4 J
={{K L
true{{M Q
;{{Q R
var~~ 
	validator~~ 
=~~ 
new~~  
DeterminismValidator~~ 0
<~~0 1!
ReconnectionGameState~~1 F
>~~F G
(~~G H
serverState~~H S
,~~S T
clientState~~U `
,~~` a
matchId~~b i
)~~i j
;~~j k
Console
ÄÄ 
.
ÄÄ 
	WriteLine
ÄÄ 
(
ÄÄ 
$str
ÄÄ 4
)
ÄÄ4 5
;
ÄÄ5 6
var
ÉÉ 

syncAction
ÉÉ 
=
ÉÉ 
new
ÉÉ 
SyncCheckAction
ÉÉ ,
{
ÉÉ- .
DomainId
ÉÉ/ 7
=
ÉÉ8 9
$num
ÉÉ: ;
,
ÉÉ; <

ExecutorId
ÉÉ= G
=
ÉÉH I
	player1Id
ÉÉJ S
}
ÉÉT U
;
ÉÉU V
var
ÑÑ 
isValid
ÑÑ 
=
ÑÑ 
	validator
ÑÑ 
.
ÑÑ  
ValidateAction
ÑÑ  .
(
ÑÑ. /

syncAction
ÖÖ 
,
ÖÖ 
(
ÜÜ 
)
ÜÜ 
=>
ÜÜ 
serverExecutor
ÜÜ  
.
ÜÜ  !
ExecuteAction
ÜÜ! .
(
ÜÜ. /

syncAction
ÜÜ/ 9
,
ÜÜ9 :
	player1Id
ÜÜ; D
)
ÜÜD E
)
áá 	
;
áá	 

	stopwatch
ââ 
.
ââ 
Stop
ââ 
(
ââ 
)
ââ 
;
ââ 
Console
éé 
.
éé 
	WriteLine
éé 
(
éé 
$str
éé ^
)
éé^ _
;
éé_ `
Console
èè 
.
èè 
	WriteLine
èè 
(
èè 
$str
èè \
)
èè\ ]
;
èè] ^
Console
êê 
.
êê 
	WriteLine
êê 
(
êê 
$str
êê \
)
êê\ ]
;
êê] ^
if
íí 

(
íí 
isValid
íí 
)
íí 
{
ìì 	
Console
îî 
.
îî 
	WriteLine
îî 
(
îî 
$str
îî _
)
îî_ `
;
îî` a
Console
ïï 
.
ïï 
	WriteLine
ïï 
(
ïï 
$str
ïï `
)
ïï` a
;
ïïa b
Console
ññ 
.
ññ 
	WriteLine
ññ 
(
ññ 
$"
ññ  
$str
ññ  3
{
ññ3 4
serverState
ññ4 ?
.
ññ? @
Counter
ññ@ G
.
ññG H
Value
ññH M
,
ññM N
$num
ññN O
}
ññO P
$str
ññP x
"
ññx y
)
ññy z
;
ññz {
Console
óó 
.
óó 
	WriteLine
óó 
(
óó 
$"
óó  
$str
óó  3
{
óó3 4
clientState
óó4 ?
.
óó? @
Counter
óó@ G
.
óóG H
Value
óóH M
,
óóM N
$num
óóN O
}
óóO P
$str
óóP x
"
óóx y
)
óóy z
;
óóz {
Console
òò 
.
òò 
	WriteLine
òò 
(
òò 
$"
òò  
$str
òò  3
{
òò3 4
serverState
òò4 ?
.
òò? @
Score
òò@ E
.
òòE F
Value
òòF K
,
òòK L
$num
òòL M
}
òòM N
$str
òòN v
"
òòv w
)
òòw x
;
òòx y
Console
ôô 
.
ôô 
	WriteLine
ôô 
(
ôô 
$"
ôô  
$str
ôô  3
{
ôô3 4
clientState
ôô4 ?
.
ôô? @
Score
ôô@ E
.
ôôE F
Value
ôôF K
,
ôôK L
$num
ôôL M
}
ôôM N
$str
ôôN v
"
ôôv w
)
ôôw x
;
ôôx y
Console
öö 
.
öö 
	WriteLine
öö 
(
öö 
$str
öö `
)
öö` a
;
ööa b
Console
õõ 
.
õõ 
	WriteLine
õõ 
(
õõ 
$"
õõ  
$str
õõ  ;
{
õõ; <
serverState
õõ< G
.
õõG H
History
õõH O
.
õõO P
Count
õõP U
,
õõU V
$num
õõV W
}
õõW X
$str
õõX w
"
õõw x
)
õõx y
;
õõy z
Console
úú 
.
úú 
	WriteLine
úú 
(
úú 
$"
úú  
$str
úú  ;
{
úú; <
	stopwatch
úú< E
.
úúE F!
ElapsedMilliseconds
úúF Y
,
úúY Z
$num
úúZ [
}
úú[ \
$str
úú\ z
"
úúz {
)
úú{ |
;
úú| }
Console
ùù 
.
ùù 
	WriteLine
ùù 
(
ùù 
$"
ùù  
$str
ùù  ;
{
ùù; <
replayStopwatch
ùù< K
.
ùùK L!
ElapsedMilliseconds
ùùL _
,
ùù_ `
$num
ùù` a
}
ùùa b
$strùùb Ä
"ùùÄ Å
)ùùÅ Ç
;ùùÇ É
Console
ûû 
.
ûû 
	WriteLine
ûû 
(
ûû 
$str
ûû `
)
ûû` a
;
ûûa b
Console
†† 
.
†† 
	WriteLine
†† 
(
†† 
$str
†† 6
)
††6 7
;
††7 8
Console
°° 
.
°° 
	WriteLine
°° 
(
°° 
$str
°° K
)
°°K L
;
°°L M
Console
¢¢ 
.
¢¢ 
	WriteLine
¢¢ 
(
¢¢ 
$str
¢¢ L
)
¢¢L M
;
¢¢M N
Console
££ 
.
££ 
	WriteLine
££ 
(
££ 
$str
££ N
)
££N O
;
££O P
Console
§§ 
.
§§ 
	WriteLine
§§ 
(
§§ 
$str
§§ N
)
§§N O
;
§§O P
}
•• 	
else
¶¶ 
{
ßß 	
Console
®® 
.
®® 
	WriteLine
®® 
(
®® 
$str
®® ^
)
®®^ _
;
®®_ `
Console
©© 
.
©© 
	WriteLine
©© 
(
©© 
$str
©© `
)
©©` a
;
©©a b
Console
™™ 
.
™™ 
	WriteLine
™™ 
(
™™ 
$"
™™  
$str
™™  3
{
™™3 4
serverState
™™4 ?
.
™™? @
Counter
™™@ G
.
™™G H
Value
™™H M
,
™™M N
$num
™™N O
}
™™O P
$str
™™P x
"
™™x y
)
™™y z
;
™™z {
Console
´´ 
.
´´ 
	WriteLine
´´ 
(
´´ 
$"
´´  
$str
´´  3
{
´´3 4
clientState
´´4 ?
.
´´? @
Counter
´´@ G
.
´´G H
Value
´´H M
,
´´M N
$num
´´N O
}
´´O P
$str
´´P x
"
´´x y
)
´´y z
;
´´z {
Console
¨¨ 
.
¨¨ 
	WriteLine
¨¨ 
(
¨¨ 
$"
¨¨  
$str
¨¨  3
{
¨¨3 4
serverState
¨¨4 ?
.
¨¨? @
Score
¨¨@ E
.
¨¨E F
Value
¨¨F K
,
¨¨K L
$num
¨¨L M
}
¨¨M N
$str
¨¨N v
"
¨¨v w
)
¨¨w x
;
¨¨x y
Console
≠≠ 
.
≠≠ 
	WriteLine
≠≠ 
(
≠≠ 
$"
≠≠  
$str
≠≠  3
{
≠≠3 4
clientState
≠≠4 ?
.
≠≠? @
Score
≠≠@ E
.
≠≠E F
Value
≠≠F K
,
≠≠K L
$num
≠≠L M
}
≠≠M N
$str
≠≠N v
"
≠≠v w
)
≠≠w x
;
≠≠x y
Console
ÆÆ 
.
ÆÆ 
	WriteLine
ÆÆ 
(
ÆÆ 
$str
ÆÆ `
)
ÆÆ` a
;
ÆÆa b
Console
∞∞ 
.
∞∞ 
	WriteLine
∞∞ 
(
∞∞ 
$str
∞∞ 6
)
∞∞6 7
;
∞∞7 8
Console
±± 
.
±± 
	WriteLine
±± 
(
±± 
$str
±± O
)
±±O P
;
±±P Q
Console
≤≤ 
.
≤≤ 
	WriteLine
≤≤ 
(
≤≤ 
$str
≤≤ P
)
≤≤P Q
;
≤≤Q R
Console
≥≥ 
.
≥≥ 
	WriteLine
≥≥ 
(
≥≥ 
$str
≥≥ @
)
≥≥@ A
;
≥≥A B
Console
¥¥ 
.
¥¥ 
	WriteLine
¥¥ 
(
¥¥ 
$str
¥¥ C
)
¥¥C D
;
¥¥D E
}
µµ 	
Console
∑∑ 
.
∑∑ 
	WriteLine
∑∑ 
(
∑∑ 
$str
∑∑ 8
)
∑∑8 9
;
∑∑9 :
}
∏∏ 
public
ΩΩ 

static
ΩΩ 
void
ΩΩ 
SpectatorExample
ΩΩ '
(
ΩΩ' (
)
ΩΩ( )
{
ææ 
Console
øø 
.
øø 
	WriteLine
øø 
(
øø 
$str
øø \
)
øø\ ]
;
øø] ^
Console
¿¿ 
.
¿¿ 
	WriteLine
¿¿ 
(
¿¿ 
$str
¿¿ \
)
¿¿\ ]
;
¿¿] ^
Console
¡¡ 
.
¡¡ 
	WriteLine
¡¡ 
(
¡¡ 
$str
¡¡ ^
)
¡¡^ _
;
¡¡_ `
var
√√ 
matchId
√√ 
=
√√ 
Guid
√√ 
.
√√ 
NewGuid
√√ "
(
√√" #
)
√√# $
;
√√$ %
var
ƒƒ 
	player1Id
ƒƒ 
=
ƒƒ 
Guid
ƒƒ 
.
ƒƒ 
NewGuid
ƒƒ $
(
ƒƒ$ %
)
ƒƒ% &
;
ƒƒ& '
var
≈≈ 
	player2Id
≈≈ 
=
≈≈ 
Guid
≈≈ 
.
≈≈ 
NewGuid
≈≈ $
(
≈≈$ %
)
≈≈% &
;
≈≈& '
var
∆∆ 
spectatorId
∆∆ 
=
∆∆ 
Guid
∆∆ 
.
∆∆ 
NewGuid
∆∆ &
(
∆∆& '
)
∆∆' (
;
∆∆( )
Console
…… 
.
…… 
	WriteLine
…… 
(
…… 
$str
…… 4
)
……4 5
;
……5 6
var
   
serverState
   
=
   
new
   #
ReconnectionGameState
   3
(
  3 4
matchId
  4 ;
)
  ; <
;
  < =
var
ÀÀ 
serverExecutor
ÀÀ 
=
ÀÀ 
new
ÀÀ  #
NetworkActionExecutor
ÀÀ! 6
(
ÀÀ6 7
serverState
ÀÀ7 B
.
ÀÀB C
Registry
ÀÀC K
)
ÀÀK L
;
ÀÀL M
for
ŒŒ 
(
ŒŒ 
int
ŒŒ 
i
ŒŒ 
=
ŒŒ 
$num
ŒŒ 
;
ŒŒ 
i
ŒŒ 
<
ŒŒ 
$num
ŒŒ 
;
ŒŒ 
i
ŒŒ  !
++
ŒŒ! #
)
ŒŒ# $
{
œœ 	
var
–– 
action
–– 
=
–– 
new
–– $
IncrementCounterAction
–– 3
{
—— 
DomainId
““ 
=
““ 
$num
““ 
,
““ 

ExecutorId
”” 
=
”” 
i
”” 
%
””  
$num
””! "
==
””# %
$num
””& '
?
””( )
	player1Id
””* 3
:
””4 5
	player2Id
””6 ?
}
‘‘ 
;
‘‘ 
serverExecutor
’’ 
.
’’ 
ExecuteAction
’’ (
(
’’( )
action
’’) /
,
’’/ 0
action
’’1 7
.
’’7 8

ExecutorId
’’8 B
)
’’B C
;
’’C D
}
÷÷ 	
Console
ÿÿ 
.
ÿÿ 
	WriteLine
ÿÿ 
(
ÿÿ 
$"
ÿÿ 
$str
ÿÿ 0
{
ÿÿ0 1
serverState
ÿÿ1 <
.
ÿÿ< =
History
ÿÿ= D
.
ÿÿD E
Count
ÿÿE J
}
ÿÿJ K
"
ÿÿK L
)
ÿÿL M
;
ÿÿM N
Console
ŸŸ 
.
ŸŸ 
	WriteLine
ŸŸ 
(
ŸŸ 
$"
ŸŸ 
$str
ŸŸ '
{
ŸŸ' (
serverState
ŸŸ( 3
.
ŸŸ3 4
Counter
ŸŸ4 ;
.
ŸŸ; <
Value
ŸŸ< A
}
ŸŸA B
$str
ŸŸB K
{
ŸŸK L
serverState
ŸŸL W
.
ŸŸW X
Score
ŸŸX ]
.
ŸŸ] ^
Value
ŸŸ^ c
}
ŸŸc d
$str
ŸŸd f
"
ŸŸf g
)
ŸŸg h
;
ŸŸh i
Console
‹‹ 
.
‹‹ 
	WriteLine
‹‹ 
(
‹‹ 
$"
‹‹ 
$str
‹‹ '
{
‹‹' (
spectatorId
‹‹( 3
}
‹‹3 4
$str
‹‹4 E
"
‹‹E F
)
‹‹F G
;
‹‹G H
var
›› 
spectatorState
›› 
=
›› 
new
››  #
ReconnectionGameState
››! 6
(
››6 7
matchId
››7 >
)
››> ?
;
››? @
var
ﬁﬁ 
spectatorExecutor
ﬁﬁ 
=
ﬁﬁ 
new
ﬁﬁ  ##
NetworkActionExecutor
ﬁﬁ$ 9
(
ﬁﬁ9 :
spectatorState
ﬁﬁ: H
.
ﬁﬁH I
Registry
ﬁﬁI Q
)
ﬁﬁQ R
;
ﬁﬁR S
foreach
·· 
(
·· 
var
·· 
action
·· 
in
·· 
serverState
·· *
.
··* +
History
··+ 2
)
··2 3
{
‚‚ 	
var
„„ 

actionJson
„„ 
=
„„ 
JsonSerializer
„„ +
.
„„+ ,
ToJson
„„, 2
(
„„2 3
action
„„3 9
)
„„9 :
;
„„: ;
var
‰‰ 
clonedAction
‰‰ 
=
‰‰ 
JsonSerializer
‰‰ -
.
‰‰- .
FromJson
‰‰. 6
<
‰‰6 7
INetworkAction
‰‰7 E
>
‰‰E F
(
‰‰F G

actionJson
‰‰G Q
)
‰‰Q R
;
‰‰R S
spectatorExecutor
ÂÂ 
.
ÂÂ 
ExecuteAction
ÂÂ +
(
ÂÂ+ ,
clonedAction
ÂÂ, 8
,
ÂÂ8 9
clonedAction
ÂÂ: F
.
ÂÂF G

ExecutorId
ÂÂG Q
)
ÂÂQ R
;
ÂÂR S
}
ÊÊ 	
Console
ËË 
.
ËË 
	WriteLine
ËË 
(
ËË 
$"
ËË 
$str
ËË :
{
ËË: ;
spectatorState
ËË; I
.
ËËI J
History
ËËJ Q
.
ËËQ R
Count
ËËR W
}
ËËW X
"
ËËX Y
)
ËËY Z
;
ËËZ [
Console
ÈÈ 
.
ÈÈ 
	WriteLine
ÈÈ 
(
ÈÈ 
$"
ÈÈ 
$str
ÈÈ '
{
ÈÈ' (
spectatorState
ÈÈ( 6
.
ÈÈ6 7
Counter
ÈÈ7 >
.
ÈÈ> ?
Value
ÈÈ? D
}
ÈÈD E
$str
ÈÈE N
{
ÈÈN O
spectatorState
ÈÈO ]
.
ÈÈ] ^
Score
ÈÈ^ c
.
ÈÈc d
Value
ÈÈd i
}
ÈÈi j
$str
ÈÈj l
"
ÈÈl m
)
ÈÈm n
;
ÈÈn o"
DeterminismValidator
ÏÏ 
<
ÏÏ #
ReconnectionGameState
ÏÏ 2
>
ÏÏ2 3
.
ÏÏ3 4
	IsEnabled
ÏÏ4 =
=
ÏÏ> ?
true
ÏÏ@ D
;
ÏÏD E
var
ÌÌ 
	validator
ÌÌ 
=
ÌÌ 
new
ÌÌ "
DeterminismValidator
ÌÌ 0
<
ÌÌ0 1#
ReconnectionGameState
ÌÌ1 F
>
ÌÌF G
(
ÌÌG H
serverState
ÌÌH S
,
ÌÌS T
spectatorState
ÌÌU c
,
ÌÌc d
matchId
ÌÌe l
)
ÌÌl m
;
ÌÌm n
var
ÔÔ 

syncAction
ÔÔ 
=
ÔÔ 
new
ÔÔ 
SyncCheckAction
ÔÔ ,
{
ÔÔ- .
DomainId
ÔÔ/ 7
=
ÔÔ8 9
$num
ÔÔ: ;
,
ÔÔ; <

ExecutorId
ÔÔ= G
=
ÔÔH I
spectatorId
ÔÔJ U
}
ÔÔV W
;
ÔÔW X
var
 
isValid
 
=
 
	validator
 
.
  
ValidateAction
  .
(
. /

syncAction
ÒÒ 
,
ÒÒ 
(
ÚÚ 
)
ÚÚ 
=>
ÚÚ 
serverExecutor
ÚÚ  
.
ÚÚ  !
ExecuteAction
ÚÚ! .
(
ÚÚ. /

syncAction
ÚÚ/ 9
,
ÚÚ9 :
spectatorId
ÚÚ; F
)
ÚÚF G
)
ÛÛ 	
;
ÛÛ	 

if
ıı 

(
ıı 
isValid
ıı 
)
ıı 
{
ˆˆ 	
Console
˜˜ 
.
˜˜ 
	WriteLine
˜˜ 
(
˜˜ 
$str
˜˜ L
)
˜˜L M
;
˜˜M N
Console
¯¯ 
.
¯¯ 
	WriteLine
¯¯ 
(
¯¯ 
$str
¯¯ F
)
¯¯F G
;
¯¯G H
}
˘˘ 	
else
˙˙ 
{
˚˚ 	
Console
¸¸ 
.
¸¸ 
	WriteLine
¸¸ 
(
¸¸ 
$str
¸¸ I
)
¸¸I J
;
¸¸J K
}
˝˝ 	
}
˛˛ 
}ˇˇ 
publicÖÖ 
class
ÖÖ #
ReconnectionGameState
ÖÖ "
:
ÖÖ# $
NetworkGameState
ÖÖ% 5
{ÜÜ 
public
áá 
!
ObservableAttribute
áá 
<
áá 
int
áá "
>
áá" #
Counter
áá$ +
{
áá, -
get
áá. 1
;
áá1 2
}
áá3 4
public
àà 
!
ObservableAttribute
àà 
<
àà 
int
àà "
>
àà" #
Score
àà$ )
{
àà* +
get
àà, /
;
àà/ 0
}
àà1 2
public
ää 
#
ReconnectionGameState
ää  
(
ää  !
Guid
ää! %
matchId
ää& -
)
ää- .
:
ää/ 0
base
ää1 5
(
ää5 6
matchId
ää6 =
,
ää= >
matchId
ää? F
.
ääF G
GetHashCode
ääG R
(
ääR S
)
ääS T
)
ääT U
{
ãã 
Counter
åå 
=
åå 
new
åå !
ObservableAttribute
åå )
<
åå) *
int
åå* -
>
åå- .
(
åå. /
$num
åå/ 0
)
åå0 1
;
åå1 2
Score
çç 
=
çç 
new
çç !
ObservableAttribute
çç '
<
çç' (
int
çç( +
>
çç+ ,
(
çç, -
$num
çç- .
)
çç. /
;
çç/ 0
}
éé 
}èè 
publicëë 
class
ëë *
ReconnectionGameStateFactory
ëë )
:
ëë* +
IGameStateFactory
ëë, =
<
ëë= >#
ReconnectionGameState
ëë> S
>
ëëS T
{íí 
public
ìì 
#
ReconnectionGameState
ìì  
CreateGameState
ìì! 0
(
ìì0 1
Guid
ìì1 5
matchId
ìì6 =
)
ìì= >
=>
ìì? A
new
ììB E#
ReconnectionGameState
ììF [
(
ìì[ \
matchId
ìì\ c
)
ììc d
;
ììd e
}îî 
publicññ 
class
ññ $
IncrementCounterAction
ññ #
:
ññ$ %
NetworkAction
ññ& 3
<
ññ3 4#
ReconnectionGameState
ññ4 I
,
ññI J$
IncrementCounterAction
ññK a
>
ñña b
{óó 
	protected
òò 
override
òò 
void
òò 
ExecuteProcess
òò *
(
òò* +#
ReconnectionGameState
òò+ @
domain
òòA G
)
òòG H
{
ôô 
domain
öö 
.
öö 
Counter
öö 
.
öö 
Value
öö 
++
öö 
;
öö 
}
õõ 
}úú 
publicûû 
class
ûû 
AddScoreAction
ûû 
:
ûû 
NetworkAction
ûû +
<
ûû+ ,#
ReconnectionGameState
ûû, A
,
ûûA B
AddScoreAction
ûûC Q
>
ûûQ R
{üü 
public
†† 

int
†† 
Points
†† 
{
†† 
get
†† 
;
†† 
set
††  
;
††  !
}
††" #
	protected
¢¢ 
override
¢¢ 
void
¢¢ 
ExecuteProcess
¢¢ *
(
¢¢* +#
ReconnectionGameState
¢¢+ @
domain
¢¢A G
)
¢¢G H
{
££ 
domain
§§ 
.
§§ 
Score
§§ 
.
§§ 
Value
§§ 
+=
§§ 
Points
§§ $
;
§§$ %
}
•• 
}¶¶ 
public®® 
class
®® 
RandomEventAction
®® 
:
®®  
NetworkAction
®®! .
<
®®. /#
ReconnectionGameState
®®/ D
,
®®D E
RandomEventAction
®®F W
>
®®W X
{©© 
	protected
™™ 
override
™™ 
void
™™ 
ExecuteProcess
™™ *
(
™™* +#
ReconnectionGameState
™™+ @
domain
™™A G
)
™™G H
{
´´ 
var
≠≠ 
randomValue
≠≠ 
=
≠≠ 
domain
≠≠  
.
≠≠  !"
RandomProviderDomain
≠≠! 5
.
≠≠5 6
Random
≠≠6 <
.
≠≠< =
Next
≠≠= A
(
≠≠A B
$num
≠≠B C
,
≠≠C D
$num
≠≠E H
)
≠≠H I
;
≠≠I J
if
ØØ 

(
ØØ 
randomValue
ØØ 
>
ØØ 
$num
ØØ 
)
ØØ 
{
∞∞ 	
domain
±± 
.
±± 
Score
±± 
.
±± 
Value
±± 
+=
±± !
randomValue
±±" -
;
±±- .
}
≤≤ 	
else
≥≥ 
{
¥¥ 	
domain
µµ 
.
µµ 
Counter
µµ 
.
µµ 
Value
µµ  
++
µµ  "
;
µµ" #
}
∂∂ 	
}
∑∑ 
}∏∏ 
public∫∫ 
class
∫∫ 
SyncCheckAction
∫∫ 
:
∫∫ 
NetworkAction
∫∫ ,
<
∫∫, -#
ReconnectionGameState
∫∫- B
,
∫∫B C
SyncCheckAction
∫∫D S
>
∫∫S T
{ªª 
	protected
ºº 
override
ºº 
void
ºº 
ExecuteProcess
ºº *
(
ºº* +#
ReconnectionGameState
ºº+ @
domain
ººA G
)
ººG H
{
ΩΩ 
}
øø 
}¿¿ ˜Ω
¨/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/DetermenismValidation/DeterminismValidation_DesyncExamples.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
;. /
public

 
class

 0
$DeterminismValidation_DesyncExamples

 1
{ 
public 

static 
void (
Example1_ReactionOrderDesync 3
(3 4
)4 5
{ 
Console 
. 
	WriteLine 
( 
$str F
)F G
;G H 
DeterminismValidator 
< 
DesyncGameState1 -
>- .
.. /
	IsEnabled/ 8
=9 :
true; ?
;? @
var 
serverDomain 
= 
new 
ServerDomain +
(+ ,
), -
;- .
var 
factory 
= 
new #
DesyncGameState1Factory 1
(1 2
)2 3
;3 4
var 
matchManager 
= 
new 
MatchManager +
<+ ,
DesyncGameState1, <
>< =
(= >
serverDomain> J
,J K
factoryL S
)S T
;T U
var 
validatingManager 
= 
new  #-
!DeterminismValidatingMatchManager$ E
<E F
DesyncGameState1F V
>V W
(W X
matchManagerX d
,d e
factoryf m
)m n
;n o
var 
matchId 
= 
Guid 
. 
NewGuid "
(" #
)# $
;$ %
var 
playerId 
= 
Guid 
. 
NewGuid #
(# $
)$ %
;% &
var 
	gameState 
= 
matchManager $
.$ %
CreateMatch% 0
(0 1
matchId1 8
)8 9
;9 :
var 
executor 
= 
new !
NetworkActionExecutor 0
(0 1
	gameState1 :
.: ;
Registry; C
)C D
;D E
validatingManager 
. !
InstallValidationHook /
(/ 0
matchId0 7
,7 8
executor9 A
)A B
;B C
Console!! 
.!! 
	WriteLine!! 
(!! 
$str!! d
)!!d e
;!!e f
var## 
action## 
=## 
new## "
TriggerReactionsAction## /
{##0 1
DomainId##2 :
=##; <
$num##= >
,##> ?

ExecutorId##@ J
=##K L
playerId##M U
}##V W
;##W X
var$$ 
success$$ 
=$$ 
executor$$ 
.$$ 
ExecuteAction$$ ,
($$, -
action$$- 3
,$$3 4
playerId$$5 =
)$$= >
;$$> ?
if&& 

(&& 
!&& 
success&& 
)&& 
{'' 	
Console(( 
.(( 
	WriteLine(( 
((( 
$str(( G
)((G H
;((H I
})) 	
else** 
{++ 	
var,, 
	validator,, 
=,, 
validatingManager,, -
.,,- .
GetValidator,,. :
(,,: ;
matchId,,; B
),,B C
;,,C D
if-- 
(-- 
	validator-- 
?-- 
.-- 
	HasFailed-- $
==--% '
true--( ,
)--, -
{.. 
Console// 
.// 
	WriteLine// !
(//! "
$str//" T
)//T U
;//U V
}00 
else11 
{22 
Console33 
.33 
	WriteLine33 !
(33! "
$str33" `
)33` a
;33a b
}44 
}55 	
validatingManager77 
.77 
OnMatchRemoved77 (
(77( )
matchId77) 0
)770 1
;771 2
matchManager88 
.88 
RemoveMatch88  
(88  !
matchId88! (
)88( )
;88) *
}99 
public?? 

static?? 
void?? *
Example2_MissingReactionDesync?? 5
(??5 6
)??6 7
{@@ 
ConsoleAA 
.AA 
	WriteLineAA 
(AA 
$strAA H
)AAH I
;AAI J 
DeterminismValidatorCC 
<CC 
DesyncGameState2CC -
>CC- .
.CC. /
	IsEnabledCC/ 8
=CC9 :
trueCC; ?
;CC? @
varEE 
serverDomainEE 
=EE 
newEE 
ServerDomainEE +
(EE+ ,
)EE, -
;EE- .
varFF 
factoryFF 
=FF 
newFF #
DesyncGameState2FactoryFF 1
(FF1 2
)FF2 3
;FF3 4
varGG 
matchManagerGG 
=GG 
newGG 
MatchManagerGG +
<GG+ ,
DesyncGameState2GG, <
>GG< =
(GG= >
serverDomainGG> J
,GGJ K
factoryGGL S
)GGS T
;GGT U
varHH 
validatingManagerHH 
=HH 
newHH  #-
!DeterminismValidatingMatchManagerHH$ E
<HHE F
DesyncGameState2HHF V
>HHV W
(HHW X
matchManagerHHX d
,HHd e
factoryHHf m
)HHm n
;HHn o
varJJ 
matchIdJJ 
=JJ 
GuidJJ 
.JJ 
NewGuidJJ "
(JJ" #
)JJ# $
;JJ$ %
varKK 
playerIdKK 
=KK 
GuidKK 
.KK 
NewGuidKK #
(KK# $
)KK$ %
;KK% &
varLL 
	gameStateLL 
=LL 
matchManagerLL $
.LL$ %
CreateMatchLL% 0
(LL0 1
matchIdLL1 8
)LL8 9
;LL9 :
varMM 
executorMM 
=MM 
newMM !
NetworkActionExecutorMM 0
(MM0 1
	gameStateMM1 :
.MM: ;
RegistryMM; C
)MMC D
;MMD E
validatingManagerNN 
.NN !
InstallValidationHookNN /
(NN/ 0
matchIdNN0 7
,NN7 8
executorNN9 A
)NNA B
;NNB C
ConsolePP 
.PP 
	WriteLinePP 
(PP 
$strPP K
)PPK L
;PPL M
varRR 
actionRR 
=RR 
newRR 
ConditionalActionRR *
{RR+ ,
DomainIdRR- 5
=RR6 7
$numRR8 9
,RR9 :

ExecutorIdRR; E
=RRF G
playerIdRRH P
}RRQ R
;RRR S
varSS 
successSS 
=SS 
executorSS 
.SS 
ExecuteActionSS ,
(SS, -
actionSS- 3
,SS3 4
playerIdSS5 =
)SS= >
;SS> ?
ifUU 

(UU 
!UU 
successUU 
)UU 
{VV 	
ConsoleWW 
.WW 
	WriteLineWW 
(WW 
$strWW G
)WWG H
;WWH I
}XX 	
elseYY 
{ZZ 	
var[[ 
	validator[[ 
=[[ 
validatingManager[[ -
.[[- .
GetValidator[[. :
([[: ;
matchId[[; B
)[[B C
;[[C D
if\\ 
(\\ 
	validator\\ 
?\\ 
.\\ 
	HasFailed\\ $
==\\% '
true\\( ,
)\\, -
{]] 
Console^^ 
.^^ 
	WriteLine^^ !
(^^! "
$str^^" T
)^^T U
;^^U V
}__ 
else`` 
{aa 
Consolebb 
.bb 
	WriteLinebb !
(bb! "
$strbb" `
)bb` a
;bba b
}cc 
}dd 	
validatingManagerff 
.ff 
OnMatchRemovedff (
(ff( )
matchIdff) 0
)ff0 1
;ff1 2
matchManagergg 
.gg 
RemoveMatchgg  
(gg  !
matchIdgg! (
)gg( )
;gg) *
}hh 
publicnn 

staticnn 
voidnn #
Example3_DomainIdDesyncnn .
(nn. /
)nn/ 0
{oo 
Consolepp 
.pp 
	WriteLinepp 
(pp 
$strpp A
)ppA B
;ppB C 
DeterminismValidatorrr 
<rr 
DesyncGameState3rr -
>rr- .
.rr. /
	IsEnabledrr/ 8
=rr9 :
truerr; ?
;rr? @
vartt 
serverDomaintt 
=tt 
newtt 
ServerDomaintt +
(tt+ ,
)tt, -
;tt- .
varuu 
factoryuu 
=uu 
newuu #
DesyncGameState3Factoryuu 1
(uu1 2
)uu2 3
;uu3 4
varvv 
matchManagervv 
=vv 
newvv 
MatchManagervv +
<vv+ ,
DesyncGameState3vv, <
>vv< =
(vv= >
serverDomainvv> J
,vvJ K
factoryvvL S
)vvS T
;vvT U
varww 
validatingManagerww 
=ww 
newww  #-
!DeterminismValidatingMatchManagerww$ E
<wwE F
DesyncGameState3wwF V
>wwV W
(wwW X
matchManagerwwX d
,wwd e
factorywwf m
)wwm n
;wwn o
varyy 
matchIdyy 
=yy 
Guidyy 
.yy 
NewGuidyy "
(yy" #
)yy# $
;yy$ %
varzz 
playerIdzz 
=zz 
Guidzz 
.zz 
NewGuidzz #
(zz# $
)zz$ %
;zz% &
var{{ 
	gameState{{ 
={{ 
matchManager{{ $
.{{$ %
CreateMatch{{% 0
({{0 1
matchId{{1 8
){{8 9
;{{9 :
var|| 
executor|| 
=|| 
new|| !
NetworkActionExecutor|| 0
(||0 1
	gameState||1 :
.||: ;
Registry||; C
)||C D
;||D E
validatingManager}} 
.}} !
InstallValidationHook}} /
(}}/ 0
matchId}}0 7
,}}7 8
executor}}9 A
)}}A B
;}}B C
Console 
. 
	WriteLine 
( 
$str _
)_ `
;` a
var
ÅÅ 
action
ÅÅ 
=
ÅÅ 
new
ÅÅ  
CreateDomainAction
ÅÅ +
{
ÅÅ, -
DomainId
ÅÅ. 6
=
ÅÅ7 8
$num
ÅÅ9 :
,
ÅÅ: ;

ExecutorId
ÅÅ< F
=
ÅÅG H
playerId
ÅÅI Q
}
ÅÅR S
;
ÅÅS T
var
ÇÇ 
success
ÇÇ 
=
ÇÇ 
executor
ÇÇ 
.
ÇÇ 
ExecuteAction
ÇÇ ,
(
ÇÇ, -
action
ÇÇ- 3
,
ÇÇ3 4
playerId
ÇÇ5 =
)
ÇÇ= >
;
ÇÇ> ?
if
ÑÑ 

(
ÑÑ 
!
ÑÑ 
success
ÑÑ 
)
ÑÑ 
{
ÖÖ 	
Console
ÜÜ 
.
ÜÜ 
	WriteLine
ÜÜ 
(
ÜÜ 
$str
ÜÜ G
)
ÜÜG H
;
ÜÜH I
}
áá 	
else
àà 
{
ââ 	
var
ää 
	validator
ää 
=
ää 
validatingManager
ää -
.
ää- .
GetValidator
ää. :
(
ää: ;
matchId
ää; B
)
ääB C
;
ääC D
if
ãã 
(
ãã 
	validator
ãã 
?
ãã 
.
ãã 
	HasFailed
ãã $
==
ãã% '
true
ãã( ,
)
ãã, -
{
åå 
Console
çç 
.
çç 
	WriteLine
çç !
(
çç! "
$str
çç" T
)
ççT U
;
ççU V
}
éé 
else
èè 
{
êê 
Console
ëë 
.
ëë 
	WriteLine
ëë !
(
ëë! "
$str
ëë" `
)
ëë` a
;
ëëa b
}
íí 
}
ìì 	
validatingManager
ïï 
.
ïï 
OnMatchRemoved
ïï (
(
ïï( )
matchId
ïï) 0
)
ïï0 1
;
ïï1 2
matchManager
ññ 
.
ññ 
RemoveMatch
ññ  
(
ññ  !
matchId
ññ! (
)
ññ( )
;
ññ) *
}
óó 
public
ùù 

static
ùù 
void
ùù &
Example4_TimeBasedDesync
ùù /
(
ùù/ 0
)
ùù0 1
{
ûû 
Console
üü 
.
üü 
	WriteLine
üü 
(
üü 
$str
üü H
)
üüH I
;
üüI J"
DeterminismValidator
°° 
<
°° 
DesyncGameState4
°° -
>
°°- .
.
°°. /
	IsEnabled
°°/ 8
=
°°9 :
true
°°; ?
;
°°? @
var
££ 
serverDomain
££ 
=
££ 
new
££ 
ServerDomain
££ +
(
££+ ,
)
££, -
;
££- .
var
§§ 
factory
§§ 
=
§§ 
new
§§ %
DesyncGameState4Factory
§§ 1
(
§§1 2
)
§§2 3
;
§§3 4
var
•• 
matchManager
•• 
=
•• 
new
•• 
MatchManager
•• +
<
••+ ,
DesyncGameState4
••, <
>
••< =
(
••= >
serverDomain
••> J
,
••J K
factory
••L S
)
••S T
;
••T U
var
¶¶ 
validatingManager
¶¶ 
=
¶¶ 
new
¶¶  #/
!DeterminismValidatingMatchManager
¶¶$ E
<
¶¶E F
DesyncGameState4
¶¶F V
>
¶¶V W
(
¶¶W X
matchManager
¶¶X d
,
¶¶d e
factory
¶¶f m
)
¶¶m n
;
¶¶n o
var
®® 
matchId
®® 
=
®® 
Guid
®® 
.
®® 
NewGuid
®® "
(
®®" #
)
®®# $
;
®®$ %
var
©© 
playerId
©© 
=
©© 
Guid
©© 
.
©© 
NewGuid
©© #
(
©©# $
)
©©$ %
;
©©% &
var
™™ 
	gameState
™™ 
=
™™ 
matchManager
™™ $
.
™™$ %
CreateMatch
™™% 0
(
™™0 1
matchId
™™1 8
)
™™8 9
;
™™9 :
var
´´ 
executor
´´ 
=
´´ 
new
´´ #
NetworkActionExecutor
´´ 0
(
´´0 1
	gameState
´´1 :
.
´´: ;
Registry
´´; C
)
´´C D
;
´´D E
validatingManager
¨¨ 
.
¨¨ #
InstallValidationHook
¨¨ /
(
¨¨/ 0
matchId
¨¨0 7
,
¨¨7 8
executor
¨¨9 A
)
¨¨A B
;
¨¨B C
Console
ÆÆ 
.
ÆÆ 
	WriteLine
ÆÆ 
(
ÆÆ 
$str
ÆÆ G
)
ÆÆG H
;
ÆÆH I
var
∞∞ 
action
∞∞ 
=
∞∞ 
new
∞∞ 
TimeBasedAction
∞∞ (
{
∞∞) *
DomainId
∞∞+ 3
=
∞∞4 5
$num
∞∞6 7
,
∞∞7 8

ExecutorId
∞∞9 C
=
∞∞D E
playerId
∞∞F N
}
∞∞O P
;
∞∞P Q
var
±± 
success
±± 
=
±± 
executor
±± 
.
±± 
ExecuteAction
±± ,
(
±±, -
action
±±- 3
,
±±3 4
playerId
±±5 =
)
±±= >
;
±±> ?
if
≥≥ 

(
≥≥ 
!
≥≥ 
success
≥≥ 
)
≥≥ 
{
¥¥ 	
Console
µµ 
.
µµ 
	WriteLine
µµ 
(
µµ 
$str
µµ G
)
µµG H
;
µµH I
}
∂∂ 	
else
∑∑ 
{
∏∏ 	
var
ππ 
	validator
ππ 
=
ππ 
validatingManager
ππ -
.
ππ- .
GetValidator
ππ. :
(
ππ: ;
matchId
ππ; B
)
ππB C
;
ππC D
if
∫∫ 
(
∫∫ 
	validator
∫∫ 
?
∫∫ 
.
∫∫ 
	HasFailed
∫∫ $
==
∫∫% '
true
∫∫( ,
)
∫∫, -
{
ªª 
Console
ºº 
.
ºº 
	WriteLine
ºº !
(
ºº! "
$str
ºº" T
)
ººT U
;
ººU V
}
ΩΩ 
else
ææ 
{
øø 
Console
¿¿ 
.
¿¿ 
	WriteLine
¿¿ !
(
¿¿! "
$str
¿¿" `
)
¿¿` a
;
¿¿a b
}
¡¡ 
}
¬¬ 	
validatingManager
ƒƒ 
.
ƒƒ 
OnMatchRemoved
ƒƒ (
(
ƒƒ( )
matchId
ƒƒ) 0
)
ƒƒ0 1
;
ƒƒ1 2
matchManager
≈≈ 
.
≈≈ 
RemoveMatch
≈≈  
(
≈≈  !
matchId
≈≈! (
)
≈≈( )
;
≈≈) *
}
∆∆ 
public
»» 

static
»» 
void
»» 
RunAllExamples
»» %
(
»»% &
)
»»& '
{
…… 
Console
   
.
   
	WriteLine
   
(
   
$str
   Z
)
  Z [
;
  [ \
Console
ÀÀ 
.
ÀÀ 
	WriteLine
ÀÀ 
(
ÀÀ 
$str
ÀÀ Z
)
ÀÀZ [
;
ÀÀ[ \
Console
ÃÃ 
.
ÃÃ 
	WriteLine
ÃÃ 
(
ÃÃ 
$str
ÃÃ \
)
ÃÃ\ ]
;
ÃÃ] ^
const
ŒŒ 
int
ŒŒ 
runsPerExample
ŒŒ  
=
ŒŒ! "
$num
ŒŒ# $
;
ŒŒ$ %
Console
–– 
.
–– 
	WriteLine
–– 
(
–– 
$"
–– 
$str
–– 1
{
––1 2
runsPerExample
––2 @
}
––@ A
$str
––A g
"
––g h
)
––h i
;
––i j
for
““ 
(
““ 
int
““ 
i
““ 
=
““ 
$num
““ 
;
““ 
i
““ 
<=
““ 
runsPerExample
““ +
;
““+ ,
i
““- .
++
““. 0
)
““0 1
{
”” 	
Console
‘‘ 
.
‘‘ 
	WriteLine
‘‘ 
(
‘‘ 
$"
‘‘  
$str
‘‘  (
{
‘‘( )
i
‘‘) *
}
‘‘* +
$str
‘‘+ ,
{
‘‘, -
runsPerExample
‘‘- ;
}
‘‘; <
$str
‘‘< B
"
‘‘B C
)
‘‘C D
;
‘‘D E*
Example1_ReactionOrderDesync
÷÷ (
(
÷÷( )
)
÷÷) *
;
÷÷* +
Console
◊◊ 
.
◊◊ 
	WriteLine
◊◊ 
(
◊◊ 
)
◊◊ 
;
◊◊  ,
Example2_MissingReactionDesync
ŸŸ *
(
ŸŸ* +
)
ŸŸ+ ,
;
ŸŸ, -
Console
⁄⁄ 
.
⁄⁄ 
	WriteLine
⁄⁄ 
(
⁄⁄ 
)
⁄⁄ 
;
⁄⁄  %
Example3_DomainIdDesync
‹‹ #
(
‹‹# $
)
‹‹$ %
;
‹‹% &
Console
›› 
.
›› 
	WriteLine
›› 
(
›› 
)
›› 
;
››  &
Example4_TimeBasedDesync
ﬂﬂ $
(
ﬂﬂ$ %
)
ﬂﬂ% &
;
ﬂﬂ& '
if
·· 
(
·· 
i
·· 
<
·· 
runsPerExample
·· "
)
··" #
{
‚‚ 
Console
„„ 
.
„„ 
	WriteLine
„„ !
(
„„! "
$str
„„" &
+
„„' (
new
„„) ,
string
„„- 3
(
„„3 4
$char
„„4 7
,
„„7 8
$num
„„9 ;
)
„„; <
+
„„= >
$str
„„? C
)
„„C D
;
„„D E
}
‰‰ 
}
ÂÂ 	
Console
ÁÁ 
.
ÁÁ 
	WriteLine
ÁÁ 
(
ÁÁ 
$str
ÁÁ \
)
ÁÁ\ ]
;
ÁÁ] ^
Console
ËË 
.
ËË 
	WriteLine
ËË 
(
ËË 
$str
ËË Z
)
ËËZ [
;
ËË[ \
Console
ÈÈ 
.
ÈÈ 
	WriteLine
ÈÈ 
(
ÈÈ 
$str
ÈÈ Z
)
ÈÈZ [
;
ÈÈ[ \
}
ÍÍ 
}ÎÎ 
publicÒÒ 
class
ÒÒ 
DesyncGameState1
ÒÒ 
:
ÒÒ 
NetworkGameState
ÒÒ  0
{ÚÚ 
public
ÛÛ 

DesyncGameState1
ÛÛ 
(
ÛÛ 
Guid
ÛÛ  
matchId
ÛÛ! (
)
ÛÛ( )
:
ÛÛ* +
base
ÛÛ, 0
(
ÛÛ0 1
matchId
ÛÛ1 8
,
ÛÛ8 9
matchId
ÛÛ: A
.
ÛÛA B
GetHashCode
ÛÛB M
(
ÛÛM N
)
ÛÛN O
)
ÛÛO P
{
ÙÙ 
Console
ıı 
.
ıı 
	WriteLine
ıı 
(
ıı 
$"
ıı 
$str
ıı G
{
ııG H
matchId
ııH O
}
ııO P
"
ııP Q
)
ııQ R
;
ııR S
var
˘˘ 
orderingValue
˘˘ 
=
˘˘ 
this
˘˘  
.
˘˘  !
GetHashCode
˘˘! ,
(
˘˘, -
)
˘˘- .
;
˘˘. /
if
˚˚ 

(
˚˚ 
orderingValue
˚˚ 
%
˚˚ 
$num
˚˚ 
==
˚˚  
$num
˚˚! "
)
˚˚" #
{
¸¸ 	
new
˝˝ 
	ReactionA
˝˝ 
(
˝˝ 
this
˝˝ 
)
˝˝ 
.
˝˝  
AddTo
˝˝  %
(
˝˝% &
Disposables
˝˝& 1
)
˝˝1 2
;
˝˝2 3
new
˛˛ 
	ReactionB
˛˛ 
(
˛˛ 
this
˛˛ 
)
˛˛ 
.
˛˛  
AddTo
˛˛  %
(
˛˛% &
Disposables
˛˛& 1
)
˛˛1 2
;
˛˛2 3
Console
ˇˇ 
.
ˇˇ 
	WriteLine
ˇˇ 
(
ˇˇ 
$"
ˇˇ  
$str
ˇˇ  T
{
ˇˇT U
orderingValue
ˇˇU b
}
ˇˇb c
$str
ˇˇc d
"
ˇˇd e
)
ˇˇe f
;
ˇˇf g
}
ÄÄ 	
else
ÅÅ 
{
ÇÇ 	
new
ÉÉ 
	ReactionB
ÉÉ 
(
ÉÉ 
this
ÉÉ 
)
ÉÉ 
.
ÉÉ  
AddTo
ÉÉ  %
(
ÉÉ% &
Disposables
ÉÉ& 1
)
ÉÉ1 2
;
ÉÉ2 3
new
ÑÑ 
	ReactionA
ÑÑ 
(
ÑÑ 
this
ÑÑ 
)
ÑÑ 
.
ÑÑ  
AddTo
ÑÑ  %
(
ÑÑ% &
Disposables
ÑÑ& 1
)
ÑÑ1 2
;
ÑÑ2 3
Console
ÖÖ 
.
ÖÖ 
	WriteLine
ÖÖ 
(
ÖÖ 
$"
ÖÖ  
$str
ÖÖ  T
{
ÖÖT U
orderingValue
ÖÖU b
}
ÖÖb c
$str
ÖÖc d
"
ÖÖd e
)
ÖÖe f
;
ÖÖf g
}
ÜÜ 	
}
áá 
}àà 
publicää 
class
ää 
	ReactionA
ää 
:
ää 
Reaction
ää !
,
ää! "
IAfterReaction
ää# 1
<
ää1 2
DesyncGameState1
ää2 B
,
ääB C$
TriggerReactionsAction
ääD Z
>
ääZ [
{ãã 
public
åå 

	ReactionA
åå 
(
åå 
DesyncGameState1
åå %
target
åå& ,
)
åå, -
:
åå. /
base
åå0 4
(
åå4 5
target
åå5 ;
)
åå; <
{
åå= >
}
åå? @
public
éé 

void
éé 
OnAfter
éé 
(
éé 
DesyncGameState1
éé (
domain
éé) /
,
éé/ 0$
TriggerReactionsAction
éé1 G
action
ééH N
)
ééN O
{
èè 
Console
êê 
.
êê 
	WriteLine
êê 
(
êê 
$str
êê 6
)
êê6 7
;
êê7 8
}
ëë 
}íí 
publicîî 
class
îî 
	ReactionB
îî 
:
îî 
Reaction
îî !
,
îî! "
IAfterReaction
îî# 1
<
îî1 2
DesyncGameState1
îî2 B
,
îîB C$
TriggerReactionsAction
îîD Z
>
îîZ [
{ïï 
public
ññ 

	ReactionB
ññ 
(
ññ 
DesyncGameState1
ññ %
target
ññ& ,
)
ññ, -
:
ññ. /
base
ññ0 4
(
ññ4 5
target
ññ5 ;
)
ññ; <
{
ññ= >
}
ññ? @
public
òò 

void
òò 
OnAfter
òò 
(
òò 
DesyncGameState1
òò (
domain
òò) /
,
òò/ 0$
TriggerReactionsAction
òò1 G
action
òòH N
)
òòN O
{
ôô 
Console
öö 
.
öö 
	WriteLine
öö 
(
öö 
$str
öö 6
)
öö6 7
;
öö7 8
}
õõ 
}úú 
publicûû 
class
ûû %
DesyncGameState1Factory
ûû $
:
ûû% &
IGameStateFactory
ûû' 8
<
ûû8 9
DesyncGameState1
ûû9 I
>
ûûI J
{üü 
public
†† 

DesyncGameState1
†† 
CreateGameState
†† +
(
††+ ,
Guid
††, 0
matchId
††1 8
)
††8 9
=>
††: <
new
††= @
DesyncGameState1
††A Q
(
††Q R
matchId
††R Y
)
††Y Z
;
††Z [
}°° 
public££ 
class
££ $
TriggerReactionsAction
££ #
:
££$ %
NetworkAction
££& 3
<
££3 4
DesyncGameState1
££4 D
,
££D E$
TriggerReactionsAction
££F \
>
££\ ]
{§§ 
	protected
•• 
override
•• 
void
•• 
ExecuteProcess
•• *
(
••* +
DesyncGameState1
••+ ;
domain
••< B
)
••B C
{
¶¶ 
Console
ßß 
.
ßß 
	WriteLine
ßß 
(
ßß 
$str
ßß C
)
ßßC D
;
ßßD E
}
®® 
}©© 
publicØØ 
class
ØØ 
DesyncGameState2
ØØ 
:
ØØ 
NetworkGameState
ØØ  0
{∞∞ 
public
±± 

DesyncGameState2
±± 
(
±± 
Guid
±±  
matchId
±±! (
)
±±( )
:
±±* +
base
±±, 0
(
±±0 1
matchId
±±1 8
,
±±8 9
matchId
±±: A
.
±±A B
GetHashCode
±±B M
(
±±M N
)
±±N O
)
±±O P
{
≤≤ 
Console
≥≥ 
.
≥≥ 
	WriteLine
≥≥ 
(
≥≥ 
$"
≥≥ 
$str
≥≥ G
{
≥≥G H
matchId
≥≥H O
}
≥≥O P
"
≥≥P Q
)
≥≥Q R
;
≥≥R S
var
∑∑ 
featureFlag
∑∑ 
=
∑∑ 
Guid
∑∑ 
.
∑∑ 
NewGuid
∑∑ &
(
∑∑& '
)
∑∑' (
.
∑∑( )
GetHashCode
∑∑) 4
(
∑∑4 5
)
∑∑5 6
%
∑∑7 8
$num
∑∑9 :
==
∑∑; =
$num
∑∑> ?
;
∑∑? @
if
ππ 

(
ππ 
featureFlag
ππ 
)
ππ 
{
∫∫ 	
Console
ªª 
.
ªª 
	WriteLine
ªª 
(
ªª 
$str
ªª Y
)
ªªY Z
;
ªªZ [
new
ºº !
ConditionalReaction
ºº #
(
ºº# $
this
ºº$ (
)
ºº( )
.
ºº) *
AddTo
ºº* /
(
ºº/ 0
Disposables
ºº0 ;
)
ºº; <
;
ºº< =
}
ΩΩ 	
else
ææ 
{
øø 	
Console
¿¿ 
.
¿¿ 
	WriteLine
¿¿ 
(
¿¿ 
$str
¿¿ V
)
¿¿V W
;
¿¿W X
}
¡¡ 	
}
¬¬ 
}√√ 
public≈≈ 
class
≈≈ !
ConditionalReaction
≈≈  
:
≈≈! "
Reaction
≈≈# +
,
≈≈+ ,
IAfterReaction
≈≈- ;
<
≈≈; <
DesyncGameState2
≈≈< L
,
≈≈L M
ConditionalAction
≈≈N _
>
≈≈_ `
{∆∆ 
public
«« 
!
ConditionalReaction
«« 
(
«« 
DesyncGameState2
«« /
target
««0 6
)
««6 7
:
««8 9
base
««: >
(
««> ?
target
««? E
)
««E F
{
««G H
}
««I J
public
…… 

void
…… 
OnAfter
…… 
(
…… 
DesyncGameState2
…… (
domain
……) /
,
……/ 0
ConditionalAction
……1 B
action
……C I
)
……I J
{
   
Console
ÀÀ 
.
ÀÀ 
	WriteLine
ÀÀ 
(
ÀÀ 
$str
ÀÀ =
)
ÀÀ= >
;
ÀÀ> ?
}
ÃÃ 
}ÕÕ 
publicœœ 
class
œœ %
DesyncGameState2Factory
œœ $
:
œœ% &
IGameStateFactory
œœ' 8
<
œœ8 9
DesyncGameState2
œœ9 I
>
œœI J
{–– 
public
—— 

DesyncGameState2
—— 
CreateGameState
—— +
(
——+ ,
Guid
——, 0
matchId
——1 8
)
——8 9
=>
——: <
new
——= @
DesyncGameState2
——A Q
(
——Q R
matchId
——R Y
)
——Y Z
;
——Z [
}““ 
public‘‘ 
class
‘‘ 
ConditionalAction
‘‘ 
:
‘‘  
NetworkAction
‘‘! .
<
‘‘. /
DesyncGameState2
‘‘/ ?
,
‘‘? @
ConditionalAction
‘‘A R
>
‘‘R S
{’’ 
	protected
÷÷ 
override
÷÷ 
void
÷÷ 
ExecuteProcess
÷÷ *
(
÷÷* +
DesyncGameState2
÷÷+ ;
domain
÷÷< B
)
÷÷B C
{
◊◊ 
Console
ÿÿ 
.
ÿÿ 
	WriteLine
ÿÿ 
(
ÿÿ 
$str
ÿÿ >
)
ÿÿ> ?
;
ÿÿ? @
}
ŸŸ 
}⁄⁄ 
public‡‡ 
class
‡‡ 
DesyncGameState3
‡‡ 
:
‡‡ 
NetworkGameState
‡‡  0
{·· 
public
‚‚ 

DesyncGameState3
‚‚ 
(
‚‚ 
Guid
‚‚  
matchId
‚‚! (
)
‚‚( )
:
‚‚* +
base
‚‚, 0
(
‚‚0 1
matchId
‚‚1 8
,
‚‚8 9
matchId
‚‚: A
.
‚‚A B
GetHashCode
‚‚B M
(
‚‚M N
)
‚‚N O
)
‚‚O P
{
„„ 
Console
‰‰ 
.
‰‰ 
	WriteLine
‰‰ 
(
‰‰ 
$"
‰‰ 
$str
‰‰ G
{
‰‰G H
matchId
‰‰H O
}
‰‰O P
"
‰‰P Q
)
‰‰Q R
;
‰‰R S
new
ÁÁ  
ChildCountReaction
ÁÁ 
(
ÁÁ 
this
ÁÁ #
)
ÁÁ# $
.
ÁÁ$ %
AddTo
ÁÁ% *
(
ÁÁ* +
Disposables
ÁÁ+ 6
)
ÁÁ6 7
;
ÁÁ7 8
}
ËË 
}ÈÈ 
publicÎÎ 
class
ÎÎ  
ChildCountReaction
ÎÎ 
:
ÎÎ  !
Reaction
ÎÎ" *
,
ÎÎ* +
IAfterReaction
ÎÎ, :
<
ÎÎ: ;
DesyncGameState3
ÎÎ; K
,
ÎÎK L 
CreateDomainAction
ÎÎM _
>
ÎÎ_ `
{ÏÏ 
public
ÌÌ 
 
ChildCountReaction
ÌÌ 
(
ÌÌ 
DesyncGameState3
ÌÌ .
target
ÌÌ/ 5
)
ÌÌ5 6
:
ÌÌ7 8
base
ÌÌ9 =
(
ÌÌ= >
target
ÌÌ> D
)
ÌÌD E
{
ÌÌF G
}
ÌÌH I
public
ÔÔ 

void
ÔÔ 
OnAfter
ÔÔ 
(
ÔÔ 
DesyncGameState3
ÔÔ (
domain
ÔÔ) /
,
ÔÔ/ 0 
CreateDomainAction
ÔÔ1 C
action
ÔÔD J
)
ÔÔJ K
{
 
var
ÚÚ 

childCount
ÚÚ 
=
ÚÚ 
domain
ÚÚ 
.
ÚÚ  

Subdomains
ÚÚ  *
.
ÚÚ* +
Count
ÚÚ+ 0
;
ÚÚ0 1
Console
ÛÛ 
.
ÛÛ 
	WriteLine
ÛÛ 
(
ÛÛ 
$"
ÛÛ 
$str
ÛÛ D
{
ÛÛD E

childCount
ÛÛE O
}
ÛÛO P
"
ÛÛP Q
)
ÛÛQ R
;
ÛÛR S
}
ÙÙ 
}ıı 
public˜˜ 
class
˜˜ %
DesyncGameState3Factory
˜˜ $
:
˜˜% &
IGameStateFactory
˜˜' 8
<
˜˜8 9
DesyncGameState3
˜˜9 I
>
˜˜I J
{¯¯ 
public
˘˘ 

DesyncGameState3
˘˘ 
CreateGameState
˘˘ +
(
˘˘+ ,
Guid
˘˘, 0
matchId
˘˘1 8
)
˘˘8 9
=>
˘˘: <
new
˘˘= @
DesyncGameState3
˘˘A Q
(
˘˘Q R
matchId
˘˘R Y
)
˘˘Y Z
;
˘˘Z [
}˙˙ 
public¸¸ 
class
¸¸  
CreateDomainAction
¸¸ 
:
¸¸  !
NetworkAction
¸¸" /
<
¸¸/ 0
DesyncGameState3
¸¸0 @
,
¸¸@ A 
CreateDomainAction
¸¸B T
>
¸¸T U
{˝˝ 
	protected
˛˛ 
override
˛˛ 
void
˛˛ 
ExecuteProcess
˛˛ *
(
˛˛* +
DesyncGameState3
˛˛+ ;
domain
˛˛< B
)
˛˛B C
{
ˇˇ 
Console
ÄÄ 
.
ÄÄ 
	WriteLine
ÄÄ 
(
ÄÄ 
$str
ÄÄ L
)
ÄÄL M
;
ÄÄM N
var
ÑÑ 
customId
ÑÑ 
=
ÑÑ 
Guid
ÑÑ 
.
ÑÑ 
NewGuid
ÑÑ #
(
ÑÑ# $
)
ÑÑ$ %
;
ÑÑ% &
var
ÖÖ 
childDomain
ÖÖ 
=
ÖÖ 
new
ÖÖ %
ChildDomainWithCustomId
ÖÖ 5
(
ÖÖ5 6
domain
ÖÖ6 <
,
ÖÖ< =
customId
ÖÖ> F
)
ÖÖF G
;
ÖÖG H
domain
ÜÜ 
.
ÜÜ 

Subdomains
ÜÜ 
.
ÜÜ 
Add
ÜÜ 
(
ÜÜ 
childDomain
ÜÜ )
)
ÜÜ) *
;
ÜÜ* +
Console
àà 
.
àà 
	WriteLine
àà 
(
àà 
$"
àà 
$str
àà A
{
ààA B
customId
ààB J
}
ààJ K
$str
ààK X
{
ààX Y
childDomain
ààY d
.
ààd e
Id
ààe g
}
ààg h
"
ààh i
)
àài j
;
ààj k
}
ââ 
}ää 
publicåå 
class
åå %
ChildDomainWithCustomId
åå $
:
åå% &

LeafDomain
åå' 1
{çç 
public
éé 

Guid
éé 
CustomId
éé 
{
éé 
get
éé 
;
éé 
}
éé  !
public
êê 
%
ChildDomainWithCustomId
êê "
(
êê" #
BranchDomain
êê# /
parent
êê0 6
,
êê6 7
Guid
êê8 <
customId
êê= E
)
êêE F
:
êêG H
base
êêI M
(
êêM N
parent
êêN T
)
êêT U
{
ëë 
CustomId
íí 
=
íí 
customId
íí 
;
íí 
}
ìì 
}îî 
publicöö 
class
öö 
DesyncGameState4
öö 
:
öö 
NetworkGameState
öö  0
{õõ 
public
úú 
!
ObservableAttribute
úú 
<
úú 
int
úú "
>
úú" #
Counter
úú$ +
{
úú, -
get
úú. 1
;
úú1 2
}
úú3 4
public
ùù 
!
ObservableAttribute
ùù 
<
ùù 
long
ùù #
>
ùù# $
	Timestamp
ùù% .
{
ùù/ 0
get
ùù1 4
;
ùù4 5
}
ùù6 7
public
üü 

DesyncGameState4
üü 
(
üü 
Guid
üü  
matchId
üü! (
)
üü( )
:
üü* +
base
üü, 0
(
üü0 1
matchId
üü1 8
,
üü8 9
matchId
üü: A
.
üüA B
GetHashCode
üüB M
(
üüM N
)
üüN O
)
üüO P
{
†† 
Counter
°° 
=
°° 
new
°° !
ObservableAttribute
°° )
<
°°) *
int
°°* -
>
°°- .
(
°°. /
$num
°°/ 0
)
°°0 1
;
°°1 2
	Timestamp
¢¢ 
=
¢¢ 
new
¢¢ !
ObservableAttribute
¢¢ +
<
¢¢+ ,
long
¢¢, 0
>
¢¢0 1
(
¢¢1 2
$num
¢¢2 3
)
¢¢3 4
;
¢¢4 5
Console
££ 
.
££ 
	WriteLine
££ 
(
££ 
$"
££ 
$str
££ G
{
££G H
matchId
££H O
}
££O P
"
££P Q
)
££Q R
;
££R S
new
¶¶ 
CounterReaction
¶¶ 
(
¶¶ 
this
¶¶  
)
¶¶  !
.
¶¶! "
AddTo
¶¶" '
(
¶¶' (
Disposables
¶¶( 3
)
¶¶3 4
;
¶¶4 5
}
ßß 
}®® 
public™™ 
class
™™ 
CounterReaction
™™ 
:
™™ 
Reaction
™™ '
,
™™' (
IAfterReaction
™™) 7
<
™™7 8
DesyncGameState4
™™8 H
,
™™H I
TimeBasedAction
™™J Y
>
™™Y Z
{´´ 
public
¨¨ 

CounterReaction
¨¨ 
(
¨¨ 
DesyncGameState4
¨¨ +
target
¨¨, 2
)
¨¨2 3
:
¨¨4 5
base
¨¨6 :
(
¨¨: ;
target
¨¨; A
)
¨¨A B
{
¨¨C D
}
¨¨E F
public
ÆÆ 

void
ÆÆ 
OnAfter
ÆÆ 
(
ÆÆ 
DesyncGameState4
ÆÆ (
domain
ÆÆ) /
,
ÆÆ/ 0
TimeBasedAction
ÆÆ1 @
action
ÆÆA G
)
ÆÆG H
{
ØØ 
Console
∞∞ 
.
∞∞ 
	WriteLine
∞∞ 
(
∞∞ 
$"
∞∞ 
$str
∞∞ D
{
∞∞D E
domain
∞∞E K
.
∞∞K L
Counter
∞∞L S
.
∞∞S T
Value
∞∞T Y
}
∞∞Y Z
"
∞∞Z [
)
∞∞[ \
;
∞∞\ ]
}
±± 
}≤≤ 
public¥¥ 
class
¥¥ %
DesyncGameState4Factory
¥¥ $
:
¥¥% &
IGameStateFactory
¥¥' 8
<
¥¥8 9
DesyncGameState4
¥¥9 I
>
¥¥I J
{µµ 
public
∂∂ 

DesyncGameState4
∂∂ 
CreateGameState
∂∂ +
(
∂∂+ ,
Guid
∂∂, 0
matchId
∂∂1 8
)
∂∂8 9
=>
∂∂: <
new
∂∂= @
DesyncGameState4
∂∂A Q
(
∂∂Q R
matchId
∂∂R Y
)
∂∂Y Z
;
∂∂Z [
}∑∑ 
publicππ 
class
ππ 
TimeBasedAction
ππ 
:
ππ 
NetworkAction
ππ ,
<
ππ, -
DesyncGameState4
ππ- =
,
ππ= >
TimeBasedAction
ππ? N
>
ππN O
{∫∫ 
	protected
ªª 
override
ªª 
void
ªª 
ExecuteProcess
ªª *
(
ªª* +
DesyncGameState4
ªª+ ;
domain
ªª< B
)
ªªB C
{
ºº 
Console
ΩΩ 
.
ΩΩ 
	WriteLine
ΩΩ 
(
ΩΩ 
$str
ΩΩ S
)
ΩΩS T
;
ΩΩT U
var
¿¿ 
now
¿¿ 
=
¿¿ 
DateTime
¿¿ 
.
¿¿ 
Now
¿¿ 
.
¿¿ 
Ticks
¿¿ $
;
¿¿$ %
domain
¡¡ 
.
¡¡ 
	Timestamp
¡¡ 
.
¡¡ 
Value
¡¡ 
=
¡¡  
now
¡¡! $
;
¡¡$ %
if
ƒƒ 

(
ƒƒ 
now
ƒƒ 
%
ƒƒ 
$num
ƒƒ 
==
ƒƒ 
$num
ƒƒ 
)
ƒƒ 
{
≈≈ 	
domain
∆∆ 
.
∆∆ 
Counter
∆∆ 
.
∆∆ 
Value
∆∆  
++
∆∆  "
;
∆∆" #
Console
«« 
.
«« 
	WriteLine
«« 
(
«« 
$"
««  
$str
««  6
{
««6 7
now
««7 :
}
««: ;
$str
««; U
{
««U V
domain
««V \
.
««\ ]
Counter
««] d
.
««d e
Value
««e j
}
««j k
"
««k l
)
««l m
;
««m n
}
»» 	
else
…… 
{
   	
domain
ÀÀ 
.
ÀÀ 
Counter
ÀÀ 
.
ÀÀ 
Value
ÀÀ  
+=
ÀÀ! #
$num
ÀÀ$ %
;
ÀÀ% &
Console
ÃÃ 
.
ÃÃ 
	WriteLine
ÃÃ 
(
ÃÃ 
$"
ÃÃ  
$str
ÃÃ  5
{
ÃÃ5 6
now
ÃÃ6 9
}
ÃÃ9 :
$str
ÃÃ: Y
{
ÃÃY Z
domain
ÃÃZ `
.
ÃÃ` a
Counter
ÃÃa h
.
ÃÃh i
Value
ÃÃi n
}
ÃÃn o
"
ÃÃo p
)
ÃÃp q
;
ÃÃq r
}
ÕÕ 	
}
ŒŒ 
}œœ  ˙
•/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/DetermenismValidation/DeterminismValidation_Complex.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
;. /
public 
class )
DeterminismValidation_Complex *
{ 
public 

static 
void 
Example 
( 
)  
{ 
Console 
. 
	WriteLine 
( 
$str J
)J K
;K L
Console 
. 
	WriteLine 
( 
$str Z
)Z [
;[ \ 
DeterminismValidator 
< 
ComplexGameState -
>- .
.. /
	IsEnabled/ 8
=9 :
true; ?
;? @ 
DeterminismValidator 
< 
ComplexGameState -
>- .
.. / 
OnDeterminismFailure/ C
+=D F
( 
matchId 
, 

actionType  
,  !

actionJson" ,
,, -

primaryLog. 8
,8 9
	shadowLog: C
,C D
mismatchIndexE R
)R S
=>T V
{ 	
Console 
. 
	WriteLine 
( 
$str I
)I J
;J K
Console 
. 
	WriteLine 
( 
$"  
$str  *
{* +
matchId+ 2
}2 3
"3 4
)4 5
;5 6
Console 
. 
	WriteLine 
( 
$"  
$str  5
{5 6

actionType6 @
}@ A
"A B
)B C
;C D
Console 
. 
	WriteLine 
( 
$"  
$str  @
{@ A
mismatchIndexA N
}N O
"O P
)P Q
;Q R
var 
	timestamp 
= 
DateTime $
.$ %
Now% (
.( )
ToString) 1
(1 2
$str2 C
)C D
;D E
var 
logDir 
= 
$" 
$str '
{' (
matchId( /
}/ 0
$str0 1
{1 2
	timestamp2 ;
}; <
"< =
;= >
	Directory   
.   
CreateDirectory   %
(  % &
logDir  & ,
)  , -
;  - .
File"" 
."" 
WriteAllText"" 
("" 
$"""  
{""  !
logDir""! '
}""' (
$str""( 4
"""4 5
,""5 6

actionJson""7 A
)""A B
;""B C
File## 
.## 
WriteAllText## 
(## 
$"##  
{##  !
logDir##! '
}##' (
$str##( 8
"##8 9
,##9 :

primaryLog##; E
)##E F
;##F G
File$$ 
.$$ 
WriteAllText$$ 
($$ 
$"$$  
{$$  !
logDir$$! '
}$$' (
$str$$( 7
"$$7 8
,$$8 9
	shadowLog$$: C
)$$C D
;$$D E
Console&& 
.&& 
	WriteLine&& 
(&& 
$"&&  
$str&&  2
{&&2 3
logDir&&3 9
}&&9 :
"&&: ;
)&&; <
;&&< =
var)) 
primaryLines)) 
=)) 

primaryLog)) )
.))) *
Split))* /
())/ 0
$char))0 4
)))4 5
;))5 6
var** 
shadowLines** 
=** 
	shadowLog** '
.**' (
Split**( -
(**- .
$char**. 2
)**2 3
;**3 4
if,, 
(,, 
mismatchIndex,, 
<,, 
primaryLines,,  ,
.,,, -
Length,,- 3
&&,,4 6
mismatchIndex,,7 D
<,,E F
shadowLines,,G R
.,,R S
Length,,S Y
),,Y Z
{-- 
Console.. 
... 
	WriteLine.. !
(..! "
$".." $
$str..$ 8
{..8 9
primaryLines..9 E
[..E F
mismatchIndex..F S
]..S T
}..T U
"..U V
)..V W
;..W X
Console// 
.// 
	WriteLine// !
(//! "
$"//" $
$str//$ 6
{//6 7
shadowLines//7 B
[//B C
mismatchIndex//C P
]//P Q
}//Q R
"//R S
)//S T
;//T U
}00 
}11 	
;11	 

Console33 
.33 
	WriteLine33 
(33 
$str33 E
)33E F
;33F G
var66 
serverDomain66 
=66 
new66 
ServerDomain66 +
(66+ ,
)66, -
;66- .
var77 
gameStateFactory77 
=77 
new77 "#
ComplexGameStateFactory77# :
(77: ;
)77; <
;77< =
var88 
matchManager88 
=88 
new88 
MatchManager88 +
<88+ ,
ComplexGameState88, <
>88< =
(88= >
serverDomain88> J
,88J K
gameStateFactory88L \
)88\ ]
;88] ^
var99 
validatingManager99 
=99 
new99  #-
!DeterminismValidatingMatchManager99$ E
<99E F
ComplexGameState99F V
>99V W
(99W X
matchManager:: 
,:: 
gameStateFactory;; 
)<< 	
;<<	 

var?? 
matchId?? 
=?? 
Guid?? 
.?? 
NewGuid?? "
(??" #
)??# $
;??$ %
var@@ 
	player1Id@@ 
=@@ 
Guid@@ 
.@@ 
NewGuid@@ $
(@@$ %
)@@% &
;@@& '
varAA 
	player2IdAA 
=AA 
GuidAA 
.AA 
NewGuidAA $
(AA$ %
)AA% &
;AA& '
varCC 
	gameStateCC 
=CC 
matchManagerCC $
.CC$ %
CreateMatchCC% 0
(CC0 1
matchIdCC1 8
)CC8 9
;CC9 :
varDD 
executorDD 
=DD 
newDD !
NetworkActionExecutorDD 0
(DD0 1
	gameStateDD1 :
.DD: ;
RegistryDD; C
)DDC D
;DDD E
validatingManagerEE 
.EE !
InstallValidationHookEE /
(EE/ 0
matchIdEE0 7
,EE7 8
executorEE9 A
)EEA B
;EEB C
ConsoleGG 
.GG 
	WriteLineGG 
(GG 
$"GG 
$strGG -
{GG- .
matchIdGG. 5
}GG5 6
"GG6 7
)GG7 8
;GG8 9
ConsoleJJ 
.JJ 
	WriteLineJJ 
(JJ 
$strJJ 6
)JJ6 7
;JJ7 8
varLL 
	stopwatchLL 
=LL 
	StopwatchLL !
.LL! "
StartNewLL" *
(LL* +
)LL+ ,
;LL, -
varMM 
randomMM 
=MM 
newMM 
RandomMM 
(MM  
$numMM  "
)MM" #
;MM# $
varNN 
actionCountNN 
=NN 
$numNN 
;NN 
varOO 
desyncDetectedOO 
=OO 
falseOO "
;OO" #
forQQ 
(QQ 
intQQ 
iQQ 
=QQ 
$numQQ 
;QQ 
iQQ 
<QQ 
$numQQ 
&&QQ  "
!QQ# $
desyncDetectedQQ$ 2
;QQ2 3
iQQ4 5
++QQ5 7
)QQ7 8
{RR 	
varSS 
playerIdSS 
=SS 
randomSS !
.SS! "
NextSS" &
(SS& '
$numSS' (
)SS( )
==SS* ,
$numSS- .
?SS/ 0
	player1IdSS1 :
:SS; <
	player2IdSS= F
;SSF G
INetworkActionVV 
actionVV !
=VV" #
randomVV$ *
.VV* +
NextVV+ /
(VV/ 0
$numVV0 1
)VV1 2
switchVV3 9
{WW 
$numXX 
=>XX 
newXX 
ComplexAction1XX '
{XX( )
DomainIdXX* 2
=XX3 4
$numXX5 6
,XX6 7

ExecutorIdXX8 B
=XXC D
playerIdXXE M
}XXN O
,XXO P
$numYY 
=>YY 
newYY 
ComplexAction2YY '
{YY( )
DomainIdYY* 2
=YY3 4
$numYY5 6
,YY6 7

ExecutorIdYY8 B
=YYC D
playerIdYYE M
}YYN O
,YYO P
_ZZ 
=>ZZ 
newZZ 
ComplexAction3ZZ '
{ZZ( )
DomainIdZZ* 2
=ZZ3 4
$numZZ5 6
,ZZ6 7

ExecutorIdZZ8 B
=ZZC D
playerIdZZE M
}ZZN O
}[[ 
;[[ 
try]] 
{^^ 
var__ 
success__ 
=__ 
executor__ &
.__& '
ExecuteAction__' 4
(__4 5
action__5 ;
,__; <
playerId__= E
)__E F
;__F G
if`` 
(`` 
!`` 
success`` 
)`` 
{aa 
desyncDetectedbb "
=bb# $
truebb% )
;bb) *
Consolecc 
.cc 
	WriteLinecc %
(cc% &
$"cc& (
$strcc( G
{ccG H
iccH I
+ccJ K
$numccL M
}ccM N
"ccN O
)ccO P
;ccP Q
breakdd 
;dd 
}ee 
actionCountgg 
++gg 
;gg 
ifii 
(ii 
(ii 
iii 
+ii 
$numii 
)ii 
%ii 
$numii  
==ii! #
$numii$ %
)ii% &
{jj 
Consolekk 
.kk 
	WriteLinekk %
(kk% &
$"kk& (
$strkk( 4
{kk4 5
ikk5 6
+kk7 8
$numkk9 :
}kk: ;
$strkk; P
"kkP Q
)kkQ R
;kkR S
}ll 
}mm 
catchnn 
(nn %
InvalidOperationExceptionnn ,
exnn- /
)nn/ 0
whennn1 5
(nn6 7
exnn7 9
.nn9 :
Messagenn: A
.nnA B
ContainsnnB J
(nnJ K
$strnnK `
)nn` a
)nna b
{oo 
desyncDetectedpp 
=pp  
truepp! %
;pp% &
Consoleqq 
.qq 
	WriteLineqq !
(qq! "
$"qq" $
$strqq$ C
{qqC D
iqqD E
+qqF G
$numqqH I
}qqI J
"qqJ K
)qqK L
;qqL M
Consolerr 
.rr 
	WriteLinerr !
(rr! "
$"rr" $
$strrr$ 2
{rr2 3
exrr3 5
.rr5 6
Messagerr6 =
}rr= >
"rr> ?
)rr? @
;rr@ A
breakss 
;ss 
}tt 
}uu 	
	stopwatchww 
.ww 
Stopww 
(ww 
)ww 
;ww 
varzz 
	validatorzz 
=zz 
validatingManagerzz )
.zz) *
GetValidatorzz* 6
(zz6 7
matchIdzz7 >
)zz> ?
;zz? @
if{{ 

({{ 
	validator{{ 
!={{ 
null{{ 
){{ 
{|| 	
Console}} 
.}} 
	WriteLine}} 
(}} 
$"}}  
$str}}  8
"}}8 9
)}}9 :
;}}: ;
Console~~ 
.~~ 
	WriteLine~~ 
(~~ 
$"~~  
$str~~  ;
{~~; <
actionCount~~< G
}~~G H
"~~H I
)~~I J
;~~J K
Console 
. 
	WriteLine 
( 
$"  
$str  6
{6 7
	validator7 @
.@ A
ActionCountA L
}L M
"M N
)N O
;O P
Console
ÄÄ 
.
ÄÄ 
	WriteLine
ÄÄ 
(
ÄÄ 
$"
ÄÄ  
$str
ÄÄ  4
{
ÄÄ4 5
	validator
ÄÄ5 >
.
ÄÄ> ?
	HasFailed
ÄÄ? H
}
ÄÄH I
"
ÄÄI J
)
ÄÄJ K
;
ÄÄK L
Console
ÅÅ 
.
ÅÅ 
	WriteLine
ÅÅ 
(
ÅÅ 
$"
ÅÅ  
$str
ÅÅ  /
{
ÅÅ/ 0
	stopwatch
ÅÅ0 9
.
ÅÅ9 :!
ElapsedMilliseconds
ÅÅ: M
}
ÅÅM N
$str
ÅÅN Q
"
ÅÅQ R
)
ÅÅR S
;
ÅÅS T
Console
ÇÇ 
.
ÇÇ 
	WriteLine
ÇÇ 
(
ÇÇ 
$"
ÇÇ  
$str
ÇÇ  3
{
ÇÇ3 4
(
ÇÇ4 5
double
ÇÇ5 ;
)
ÇÇ; <
	stopwatch
ÇÇ< E
.
ÇÇE F!
ElapsedMilliseconds
ÇÇF Y
/
ÇÇZ [
actionCount
ÇÇ\ g
:
ÇÇg h
$str
ÇÇh j
}
ÇÇj k
$str
ÇÇk n
"
ÇÇn o
)
ÇÇo p
;
ÇÇp q
if
ÑÑ 
(
ÑÑ 
!
ÑÑ 
	validator
ÑÑ 
.
ÑÑ 
	HasFailed
ÑÑ $
)
ÑÑ$ %
{
ÖÖ 
Console
ÜÜ 
.
ÜÜ 
	WriteLine
ÜÜ !
(
ÜÜ! "
$"
ÜÜ" $
$str
ÜÜ$ ,
{
ÜÜ, -
actionCount
ÜÜ- 8
}
ÜÜ8 9
$str
ÜÜ9 ]
"
ÜÜ] ^
)
ÜÜ^ _
;
ÜÜ_ `
}
áá 
}
àà 	
validatingManager
ãã 
.
ãã 
OnMatchRemoved
ãã (
(
ãã( )
matchId
ãã) 0
)
ãã0 1
;
ãã1 2
matchManager
åå 
.
åå 
RemoveMatch
åå  
(
åå  !
matchId
åå! (
)
åå( )
;
åå) *
Console
éé 
.
éé 
	WriteLine
éé 
(
éé 
$str
éé 6
)
éé6 7
;
éé7 8
}
èè 
public
ïï 

static
ïï 
void
ïï !
DebugSpecificDesync
ïï *
(
ïï* +
)
ïï+ ,
{
ññ 
Console
óó 
.
óó 
	WriteLine
óó 
(
óó 
$str
óó H
)
óóH I
;
óóI J
Console
òò 
.
òò 
	WriteLine
òò 
(
òò 
$str
òò ^
)
òò^ _
;
òò_ `"
DeterminismValidator
öö 
<
öö 
ComplexGameState
öö -
>
öö- .
.
öö. /
	IsEnabled
öö/ 8
=
öö9 :
true
öö; ?
;
öö? @"
DeterminismValidator
ùù 
<
ùù 
ComplexGameState
ùù -
>
ùù- .
.
ùù. /"
OnDeterminismFailure
ùù/ C
+=
ùùD F
(
ûû 
matchId
ûû 
,
ûû 

actionType
ûû  
,
ûû  !

actionJson
ûû" ,
,
ûû, -

primaryLog
ûû. 8
,
ûû8 9
	shadowLog
ûû: C
,
ûûC D
mismatchIndex
ûûE R
)
ûûR S
=>
ûûT V
{
üü 	
Console
†† 
.
†† 
	WriteLine
†† 
(
†† 
$str
†† 8
)
††8 9
;
††9 :
var
¢¢ 
primaryEvents
¢¢ 
=
¢¢ 

primaryLog
¢¢  *
.
¢¢* +
Split
¢¢+ 0
(
¢¢0 1
$char
¢¢1 5
)
¢¢5 6
;
¢¢6 7
var
££ 
shadowEvents
££ 
=
££ 
	shadowLog
££ (
.
££( )
Split
££) .
(
££. /
$char
££/ 3
)
££3 4
;
££4 5
var
¶¶ 
contextStart
¶¶ 
=
¶¶ 
Math
¶¶ #
.
¶¶# $
Max
¶¶$ '
(
¶¶' (
$num
¶¶( )
,
¶¶) *
mismatchIndex
¶¶+ 8
-
¶¶9 :
$num
¶¶; <
)
¶¶< =
;
¶¶= >
var
ßß 

contextEnd
ßß 
=
ßß 
Math
ßß !
.
ßß! "
Min
ßß" %
(
ßß% &
Math
ßß& *
.
ßß* +
Max
ßß+ .
(
ßß. /
primaryEvents
ßß/ <
.
ßß< =
Length
ßß= C
,
ßßC D
shadowEvents
ßßE Q
.
ßßQ R
Length
ßßR X
)
ßßX Y
,
ßßY Z
mismatchIndex
ßß[ h
+
ßßi j
$num
ßßk l
)
ßßl m
;
ßßm n
Console
©© 
.
©© 
	WriteLine
©© 
(
©© 
$str
©© 7
)
©©7 8
;
©©8 9
for
™™ 
(
™™ 
int
™™ 
i
™™ 
=
™™ 
contextStart
™™ %
;
™™% &
i
™™' (
<
™™) *

contextEnd
™™+ 5
;
™™5 6
i
™™7 8
++
™™8 :
)
™™: ;
{
´´ 
var
¨¨ 
marker
¨¨ 
=
¨¨ 
i
¨¨ 
==
¨¨ !
mismatchIndex
¨¨" /
?
¨¨0 1
$str
¨¨2 8
:
¨¨9 :
$str
¨¨; A
;
¨¨A B
if
ÆÆ 
(
ÆÆ 
i
ÆÆ 
<
ÆÆ 
primaryEvents
ÆÆ %
.
ÆÆ% &
Length
ÆÆ& ,
)
ÆÆ, -
Console
ØØ 
.
ØØ 
	WriteLine
ØØ %
(
ØØ% &
$"
ØØ& (
{
ØØ( )
marker
ØØ) /
}
ØØ/ 0
$str
ØØ0 3
{
ØØ3 4
primaryEvents
ØØ4 A
[
ØØA B
i
ØØB C
]
ØØC D
}
ØØD E
"
ØØE F
)
ØØF G
;
ØØG H
else
∞∞ 
Console
±± 
.
±± 
	WriteLine
±± %
(
±±% &
$"
±±& (
{
±±( )
marker
±±) /
}
±±/ 0
$str
±±0 <
"
±±< =
)
±±= >
;
±±> ?
if
≥≥ 
(
≥≥ 
i
≥≥ 
<
≥≥ 
shadowEvents
≥≥ $
.
≥≥$ %
Length
≥≥% +
)
≥≥+ ,
Console
¥¥ 
.
¥¥ 
	WriteLine
¥¥ %
(
¥¥% &
$"
¥¥& (
{
¥¥( )
marker
¥¥) /
}
¥¥/ 0
$str
¥¥0 3
{
¥¥3 4
shadowEvents
¥¥4 @
[
¥¥@ A
i
¥¥A B
]
¥¥B C
}
¥¥C D
"
¥¥D E
)
¥¥E F
;
¥¥F G
else
µµ 
Console
∂∂ 
.
∂∂ 
	WriteLine
∂∂ %
(
∂∂% &
$"
∂∂& (
{
∂∂( )
marker
∂∂) /
}
∂∂/ 0
$str
∂∂0 <
"
∂∂< =
)
∂∂= >
;
∂∂> ?
if
∏∏ 
(
∏∏ 
i
∏∏ 
==
∏∏ 
mismatchIndex
∏∏ &
)
∏∏& '
Console
ππ 
.
ππ 
	WriteLine
ππ %
(
ππ% &
$str
ππ& D
)
ππD E
;
ππE F
Console
ªª 
.
ªª 
	WriteLine
ªª !
(
ªª! "
)
ªª" #
;
ªª# $
}
ºº 
Console
øø 
.
øø 
	WriteLine
øø 
(
øø 
$str
øø 3
)
øø3 4
;
øø4 5
if
¿¿ 
(
¿¿ 
mismatchIndex
¿¿ 
<
¿¿ 
primaryEvents
¿¿  -
.
¿¿- .
Length
¿¿. 4
&&
¿¿5 7
mismatchIndex
¿¿8 E
<
¿¿F G
shadowEvents
¿¿H T
.
¿¿T U
Length
¿¿U [
)
¿¿[ \
{
¡¡ 
var
¬¬ 
primaryEvent
¬¬  
=
¬¬! "
primaryEvents
¬¬# 0
[
¬¬0 1
mismatchIndex
¬¬1 >
]
¬¬> ?
;
¬¬? @
var
√√ 
shadowEvent
√√ 
=
√√  !
shadowEvents
√√" .
[
√√. /
mismatchIndex
√√/ <
]
√√< =
;
√√= >
if
≈≈ 
(
≈≈ 
primaryEvent
≈≈  
.
≈≈  !
Contains
≈≈! )
(
≈≈) *
$str
≈≈* 4
)
≈≈4 5
&&
≈≈6 8
shadowEvent
≈≈9 D
.
≈≈D E
Contains
≈≈E M
(
≈≈M N
$str
≈≈N X
)
≈≈X Y
)
≈≈Y Z
{
∆∆ 
Console
«« 
.
«« 
	WriteLine
«« %
(
««% &
$str
««& X
)
««X Y
;
««Y Z
Console
»» 
.
»» 
	WriteLine
»» %
(
»»% &
$str
»»& e
)
»»e f
;
»»f g
Console
…… 
.
…… 
	WriteLine
…… %
(
……% &
$str
……& ^
)
……^ _
;
……_ `
}
   
else
ÀÀ 
if
ÀÀ 
(
ÀÀ 
primaryEvent
ÀÀ %
.
ÀÀ% &
Contains
ÀÀ& .
(
ÀÀ. /
$str
ÀÀ/ 7
)
ÀÀ7 8
!=
ÀÀ9 ;
shadowEvent
ÀÀ< G
.
ÀÀG H
Contains
ÀÀH P
(
ÀÀP Q
$str
ÀÀQ Y
)
ÀÀY Z
)
ÀÀZ [
{
ÃÃ 
Console
ÕÕ 
.
ÕÕ 
	WriteLine
ÕÕ %
(
ÕÕ% &
$str
ÕÕ& F
)
ÕÕF G
;
ÕÕG H
Console
ŒŒ 
.
ŒŒ 
	WriteLine
ŒŒ %
(
ŒŒ% &
$str
ŒŒ& p
)
ŒŒp q
;
ŒŒq r
}
œœ 
}
–– 
else
—— 
{
““ 
Console
”” 
.
”” 
	WriteLine
”” !
(
””! "
$str
””" W
)
””W X
;
””X Y
Console
‘‘ 
.
‘‘ 
	WriteLine
‘‘ !
(
‘‘! "
$str
‘‘" [
)
‘‘[ \
;
‘‘\ ]
Console
’’ 
.
’’ 
	WriteLine
’’ !
(
’’! "
$str
’’" ^
)
’’^ _
;
’’_ `
}
÷÷ 
}
◊◊ 	
;
◊◊	 

var
⁄⁄ 
serverDomain
⁄⁄ 
=
⁄⁄ 
new
⁄⁄ 
ServerDomain
⁄⁄ +
(
⁄⁄+ ,
)
⁄⁄, -
;
⁄⁄- .
var
€€ 
gameStateFactory
€€ 
=
€€ 
new
€€ "%
ComplexGameStateFactory
€€# :
(
€€: ;
)
€€; <
;
€€< =
var
‹‹ 
matchManager
‹‹ 
=
‹‹ 
new
‹‹ 
MatchManager
‹‹ +
<
‹‹+ ,
ComplexGameState
‹‹, <
>
‹‹< =
(
‹‹= >
serverDomain
‹‹> J
,
‹‹J K
gameStateFactory
‹‹L \
)
‹‹\ ]
;
‹‹] ^
var
›› 
validatingManager
›› 
=
›› 
new
››  #/
!DeterminismValidatingMatchManager
››$ E
<
››E F
ComplexGameState
››F V
>
››V W
(
››W X
matchManager
ﬁﬁ 
,
ﬁﬁ 
gameStateFactory
ﬂﬂ 
)
‡‡ 	
;
‡‡	 

var
‚‚ 
matchId
‚‚ 
=
‚‚ 
Guid
‚‚ 
.
‚‚ 
NewGuid
‚‚ "
(
‚‚" #
)
‚‚# $
;
‚‚$ %
var
„„ 
playerId
„„ 
=
„„ 
Guid
„„ 
.
„„ 
NewGuid
„„ #
(
„„# $
)
„„$ %
;
„„% &
var
‰‰ 
	gameState
‰‰ 
=
‰‰ 
matchManager
‰‰ $
.
‰‰$ %
CreateMatch
‰‰% 0
(
‰‰0 1
matchId
‰‰1 8
)
‰‰8 9
;
‰‰9 :
var
ÂÂ 
executor
ÂÂ 
=
ÂÂ 
new
ÂÂ #
NetworkActionExecutor
ÂÂ 0
(
ÂÂ0 1
	gameState
ÂÂ1 :
.
ÂÂ: ;
Registry
ÂÂ; C
)
ÂÂC D
;
ÂÂD E
validatingManager
ÊÊ 
.
ÊÊ #
InstallValidationHook
ÊÊ /
(
ÊÊ/ 0
matchId
ÊÊ0 7
,
ÊÊ7 8
executor
ÊÊ9 A
)
ÊÊA B
;
ÊÊB C
Console
ËË 
.
ËË 
	WriteLine
ËË 
(
ËË 
$str
ËË ;
)
ËË; <
;
ËË< =
var
ÎÎ 
problematicAction
ÎÎ 
=
ÎÎ 
new
ÎÎ  #
ProblematicAction
ÎÎ$ 5
{
ÎÎ6 7
DomainId
ÎÎ8 @
=
ÎÎA B
$num
ÎÎC D
,
ÎÎD E

ExecutorId
ÎÎF P
=
ÎÎQ R
playerId
ÎÎS [
}
ÎÎ\ ]
;
ÎÎ] ^
executor
ÏÏ 
.
ÏÏ 
ExecuteAction
ÏÏ 
(
ÏÏ 
problematicAction
ÏÏ 0
,
ÏÏ0 1
playerId
ÏÏ2 :
)
ÏÏ: ;
;
ÏÏ; <
validatingManager
ÓÓ 
.
ÓÓ 
OnMatchRemoved
ÓÓ (
(
ÓÓ( )
matchId
ÓÓ) 0
)
ÓÓ0 1
;
ÓÓ1 2
matchManager
ÔÔ 
.
ÔÔ 
RemoveMatch
ÔÔ  
(
ÔÔ  !
matchId
ÔÔ! (
)
ÔÔ( )
;
ÔÔ) *
}
 
}ÒÒ 
publicÙÙ 
class
ÙÙ 
ComplexGameState
ÙÙ 
:
ÙÙ 
NetworkGameState
ÙÙ  0
{ıı 
public
ˆˆ 
!
ObservableAttribute
ˆˆ 
<
ˆˆ 
int
ˆˆ "
>
ˆˆ" #
	TurnCount
ˆˆ$ -
{
ˆˆ. /
get
ˆˆ0 3
;
ˆˆ3 4
}
ˆˆ5 6
public
˜˜ 
!
ObservableAttribute
˜˜ 
<
˜˜ 
int
˜˜ "
>
˜˜" #
Score
˜˜$ )
{
˜˜* +
get
˜˜, /
;
˜˜/ 0
}
˜˜1 2
public
˘˘ 

ComplexGameState
˘˘ 
(
˘˘ 
Guid
˘˘  
matchId
˘˘! (
)
˘˘( )
:
˘˘* +
base
˘˘, 0
(
˘˘0 1
matchId
˘˘1 8
,
˘˘8 9
matchId
˘˘: A
.
˘˘A B
GetHashCode
˘˘B M
(
˘˘M N
)
˘˘N O
)
˘˘O P
{
˙˙ 
	TurnCount
˚˚ 
=
˚˚ 
new
˚˚ !
ObservableAttribute
˚˚ +
<
˚˚+ ,
int
˚˚, /
>
˚˚/ 0
(
˚˚0 1
$num
˚˚1 2
)
˚˚2 3
;
˚˚3 4
Score
¸¸ 
=
¸¸ 
new
¸¸ !
ObservableAttribute
¸¸ '
<
¸¸' (
int
¸¸( +
>
¸¸+ ,
(
¸¸, -
$num
¸¸- .
)
¸¸. /
;
¸¸/ 0
new
ˇˇ 
Reaction
ˇˇ 
<
ˇˇ 
ComplexGameState
ˇˇ %
,
ˇˇ% &
ComplexAction1
ˇˇ' 5
>
ˇˇ5 6
(
ˇˇ6 7
this
ˇˇ7 ;
)
ˇˇ; <
.
ÄÄ 
After
ÄÄ 
(
ÄÄ 
(
ÄÄ 
domain
ÄÄ 
,
ÄÄ 
action
ÄÄ "
)
ÄÄ" #
=>
ÄÄ$ &
{
ÄÄ' (
	TurnCount
ÅÅ 
.
ÅÅ 
Value
ÅÅ 
++
ÅÅ !
;
ÅÅ! "
Console
ÇÇ 
.
ÇÇ 
	WriteLine
ÇÇ !
(
ÇÇ! "
$"
ÇÇ" $
$str
ÇÇ$ N
{
ÇÇN O
	TurnCount
ÇÇO X
.
ÇÇX Y
Value
ÇÇY ^
}
ÇÇ^ _
"
ÇÇ_ `
)
ÇÇ` a
;
ÇÇa b
}
ÉÉ 
)
ÉÉ 
.
ÑÑ 
AddTo
ÑÑ 
(
ÑÑ 
Disposables
ÑÑ 
)
ÑÑ 
;
ÑÑ  
new
ÜÜ 
Reaction
ÜÜ 
<
ÜÜ 
ComplexGameState
ÜÜ %
,
ÜÜ% &
ComplexAction1
ÜÜ' 5
>
ÜÜ5 6
(
ÜÜ6 7
this
ÜÜ7 ;
)
ÜÜ; <
.
áá 
After
áá 
(
áá 
(
áá 
domain
áá 
,
áá 
action
áá "
)
áá" #
=>
áá$ &
{
áá' (
Score
àà 
.
àà 
Value
àà 
+=
àà 
$num
àà !
;
àà! "
Console
ââ 
.
ââ 
	WriteLine
ââ !
(
ââ! "
$"
ââ" $
$str
ââ$ H
{
ââH I
Score
ââI N
.
ââN O
Value
ââO T
}
ââT U
"
ââU V
)
ââV W
;
ââW X
}
ää 
)
ää 
.
ãã 
AddTo
ãã 
(
ãã 
Disposables
ãã 
)
ãã 
;
ãã  
}
åå 
}çç 
publicèè 
class
èè %
ComplexGameStateFactory
èè $
:
èè% &
IGameStateFactory
èè' 8
<
èè8 9
ComplexGameState
èè9 I
>
èèI J
{êê 
public
ëë 

ComplexGameState
ëë 
CreateGameState
ëë +
(
ëë+ ,
Guid
ëë, 0
matchId
ëë1 8
)
ëë8 9
=>
ëë: <
new
ëë= @
ComplexGameState
ëëA Q
(
ëëQ R
matchId
ëëR Y
)
ëëY Z
;
ëëZ [
}íí 
publicïï 
class
ïï 
ComplexAction1
ïï 
:
ïï 
NetworkAction
ïï +
<
ïï+ ,
ComplexGameState
ïï, <
,
ïï< =
ComplexAction1
ïï> L
>
ïïL M
{ññ 
	protected
óó 
override
óó 
void
óó 
ExecuteProcess
óó *
(
óó* +
ComplexGameState
óó+ ;
domain
óó< B
)
óóB C
{
òò 
Console
ôô 
.
ôô 
	WriteLine
ôô 
(
ôô 
$"
ôô 
$str
ôô ;
"
ôô; <
)
ôô< =
;
ôô= >
}
öö 
}õõ 
publicùù 
class
ùù 
ComplexAction2
ùù 
:
ùù 
NetworkAction
ùù +
<
ùù+ ,
ComplexGameState
ùù, <
,
ùù< =
ComplexAction2
ùù> L
>
ùùL M
{ûû 
	protected
üü 
override
üü 
void
üü 
ExecuteProcess
üü *
(
üü* +
ComplexGameState
üü+ ;
domain
üü< B
)
üüB C
{
†† 
Console
°° 
.
°° 
	WriteLine
°° 
(
°° 
$"
°° 
$str
°° ;
"
°°; <
)
°°< =
;
°°= >
domain
¢¢ 
.
¢¢ 
Score
¢¢ 
.
¢¢ 
Value
¢¢ 
+=
¢¢ 
$num
¢¢ 
;
¢¢  
}
££ 
}§§ 
public¶¶ 
class
¶¶ 
ComplexAction3
¶¶ 
:
¶¶ 
NetworkAction
¶¶ +
<
¶¶+ ,
ComplexGameState
¶¶, <
,
¶¶< =
ComplexAction3
¶¶> L
>
¶¶L M
{ßß 
	protected
®® 
override
®® 
void
®® 
ExecuteProcess
®® *
(
®®* +
ComplexGameState
®®+ ;
domain
®®< B
)
®®B C
{
©© 
Console
™™ 
.
™™ 
	WriteLine
™™ 
(
™™ 
$"
™™ 
$str
™™ ;
"
™™; <
)
™™< =
;
™™= >
domain
´´ 
.
´´ 
	TurnCount
´´ 
.
´´ 
Value
´´ 
++
´´  
;
´´  !
}
¨¨ 
}≠≠ 
public∞∞ 
class
∞∞ 
ProblematicAction
∞∞ 
:
∞∞  
NetworkAction
∞∞! .
<
∞∞. /
ComplexGameState
∞∞/ ?
,
∞∞? @
ProblematicAction
∞∞A R
>
∞∞R S
{±± 
	protected
≤≤ 
override
≤≤ 
void
≤≤ 
ExecuteProcess
≤≤ *
(
≤≤* +
ComplexGameState
≤≤+ ;
domain
≤≤< B
)
≤≤B C
{
≥≥ 
Console
¥¥ 
.
¥¥ 
	WriteLine
¥¥ 
(
¥¥ 
$"
¥¥ 
$str
¥¥ >
"
¥¥> ?
)
¥¥? @
;
¥¥@ A
var
∏∏ 
shouldTriggerBug
∏∏ 
=
∏∏ 
domain
∏∏ %
.
∏∏% &
GetHashCode
∏∏& 1
(
∏∏1 2
)
∏∏2 3
%
∏∏4 5
$num
∏∏6 7
==
∏∏8 :
$num
∏∏; <
;
∏∏< =
if
∫∫ 

(
∫∫ 
shouldTriggerBug
∫∫ 
)
∫∫ 
{
ªª 	
domain
ΩΩ 
.
ΩΩ 
Score
ΩΩ 
.
ΩΩ 
Value
ΩΩ 
+=
ΩΩ !
$num
ΩΩ" %
;
ΩΩ% &
}
ææ 	
}
øø 
}¿¿ • 
ò/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/Advanced/Example08_GlobalNotifications.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
.. /
Advanced/ 7
;7 8
public 
static 
class )
Example08_GlobalNotifications 1
{ 
public 

static 
void 
Run 
( 
) 
{ 
var 
root 
= 
new 

RootDomain !
(! "
)" #
;# $
var   
domainA   
=   
new   
DomainA   !
(  ! "
root  " &
)  & '
;  ' (
var## 
domainB## 
=## 
new## 
DomainB## !
(##! "
root##" &
)##& '
;##' (
domainA'' 
.'' 
DoSomething'' 
('' 
$str'' +
)''+ ,
;'', -
root)) 
.)) 
Dispose)) 
()) 
))) 
;)) 
}** 
}++ 
public00 
class00 
DomainA00 
:00 
BranchDomain00 #
{11 
public22 

DomainA22 
(22 
BranchDomain22 
parent22  &
)22& '
:22( )
base22* .
(22. /
parent22/ 5
)225 6
{227 8
}229 :
public44 

void44 
DoSomething44 
(44 
string44 "
message44# *
)44* +
{55 
Console66 
.66 
	WriteLine66 
(66 
$"66 
$str66 8
{668 9
message669 @
}66@ A
"66A B
)66B C
;66C D
new99 #
SomethingHappenedAction99 #
{99$ %
Message99& -
=99. /
message990 7
}998 9
.999 :
Execute99: A
(99A B
this99B F
)99F G
;99G H
}:: 
};; 
public@@ 
class@@ 
DomainB@@ 
:@@ 
BranchDomain@@ #
{AA 
publicBB 

DomainBBB 
(BB 
BranchDomainBB 
parentBB  &
)BB& '
:BB( )
baseBB* .
(BB. /
parentBB/ 5
)BB5 6
{CC 
varEE 
rootEE 
=EE 
GetInParentEE 
<EE 

RootDomainEE )
>EE) *
(EE* +
includeSelfEE+ 6
:EE6 7
falseEE8 =
)EE= >
;EE> ?
newHH 
ReactionHH 
<HH 

LeafDomainHH 
,HH  #
SomethingHappenedActionHH! 8
>HH8 9
(HH9 :
rootHH: >
)HH> ?
.II 
AfterII 
(II 
(II 
_II 
,II 
actionII 
)II 
=>II !
{JJ 
ConsoleKK 
.KK 
	WriteLineKK !
(KK! "
$"KK" $
$strKK$ F
{KKF G
actionKKG M
.KKM N
MessageKKN U
}KKU V
"KKV W
)KKW X
;KKX Y
}LL 
)LL 
.MM 
AddToMM 
(MM 
DisposablesMM 
)MM 
;MM  
}NN 
}OO 
publicTT 
classTT #
SomethingHappenedActionTT $
:TT% &
	DARActionTT' 0
<TT0 1

LeafDomainTT1 ;
,TT; <#
SomethingHappenedActionTT= T
>TTT U
{UU 
publicVV 

stringVV 
MessageVV 
{VV 
getVV 
;VV  
setVV! $
;VV$ %
}VV& '
	protectedXX 
overrideXX 
voidXX 
ExecuteProcessXX *
(XX* +

LeafDomainXX+ 5
domainXX6 <
)XX< =
{YY 
}[[ 
}\\ úÄ
è/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/Advanced/Example07_DuckTyping.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
.. /
Advanced/ 7
;7 8
public 
static 
class  
Example07_DuckTyping (
{ 
public 

static 
void 
Run 
( 
) 
{ 
var 
game 
= 
new 
	GameWorld  
(  !
)! "
;" #
var 
player 
= 
new 
Player 
(  
game  $
,$ %
$str& ,
), -
{. /
Health0 6
=7 8
$num9 <
}= >
;> ?
var 
enemy 
= 
new 
Enemy 
( 
game "
," #
$str$ ,
), -
{. /
Health0 6
=7 8
$num9 ;
}< =
;= >
var 
wall 
= 
new 
Wall 
( 
game  
)  !
{" #
Health$ *
=+ ,
$num- 0
}1 2
;2 3
var 
bullet 
= 
new 
Bullet 
(  
game  $
)$ %
{& '
Health( .
=/ 0
$num1 2
}3 4
;4 5
Console 
. 
	WriteLine 
( 
$str 1
)1 2
;2 3
PrintHealth 
( 
player 
, 
enemy !
,! "
wall# '
,' (
bullet) /
)/ 0
;0 1
var 
damage 
= 
new 
DamageAction %
{& '
Amount( .
=/ 0
$num1 3
}4 5
;5 6
Console   
.   
	WriteLine   
(   
$str   G
)  G H
;  H I
damage!! 
.!! 
Execute!! 
(!! 
player!! 
)!! 
;!! 
damage"" 
."" 
Execute"" 
("" 
enemy"" 
)"" 
;"" 
damage## 
.## 
Execute## 
(## 
wall## 
)## 
;## 
damage$$ 
.$$ 
Execute$$ 
($$ 
bullet$$ 
)$$ 
;$$ 
PrintHealth&& 
(&& 
player&& 
,&& 
enemy&& !
,&&! "
wall&&# '
,&&' (
bullet&&) /
)&&/ 0
;&&0 1
Console)) 
.)) 
	WriteLine)) 
()) 
$str)) 7
)))7 8
;))8 9
var** 
playerWithArmor** 
=** 
new** !
Player**" (
(**( )
game**) -
,**- .
$str**/ 7
)**7 8
{**9 :
Health**; A
=**B C
$num**D G
}**H I
;**I J
var++ 
armor++ 
=++ 
new++ 
ArmorComponent++ &
(++& '
playerWithArmor++' 6
)++6 7
{++8 9
Defense++: A
=++B C
$num++D F
}++G H
;++H I
Console-- 
.-- 
	WriteLine-- 
(-- 
$"-- 
$str-- A
{--A B
armor--B G
.--G H
Defense--H O
}--O P
$str--P Q
"--Q R
)--R S
;--S T
Console.. 
... 
	WriteLine.. 
(.. 
$".. 
$str.. 0
{..0 1
playerWithArmor..1 @
...@ A
Health..A G
}..G H
"..H I
)..I J
;..J K
damage11 
.11 
Execute11 
(11 
armor11 
)11 
;11 
Console33 
.33 
	WriteLine33 
(33 
$"33 
$str33 /
{33/ 0
playerWithArmor330 ?
.33? @
Health33@ F
}33F G
"33G H
)33H I
;33I J
Console44 
.44 
	WriteLine44 
(44 
$str44 N
)44N O
;44O P
game66 
.66 
Dispose66 
(66 
)66 
;66 
}77 
private99 
static99 
void99 
PrintHealth99 #
(99# $
params99$ *
IDamageable99+ 6
[996 7
]997 8
entities999 A
)99A B
{:: 
foreach;; 
(;; 
var;; 
entity;; 
in;; 
entities;; '
);;' (
{<< 	
var== 
name== 
=== 
entity== 
switch== $
{>> 
Player?? 
p?? 
=>?? 
$"?? 
$str?? &
{??& '
p??' (
.??( )
Name??) -
}??- .
$str??. /
"??/ 0
,??0 1
Enemy@@ 
e@@ 
=>@@ 
$"@@ 
$str@@ $
{@@$ %
e@@% &
.@@& '
Type@@' +
}@@+ ,
$str@@, -
"@@- .
,@@. /
WallAA 
=>AA 
$strAA 
,AA 
BulletBB 
=>BB 
$strBB "
,BB" #
_CC 
=>CC 
$strCC 
}DD 
;DD 
ConsoleEE 
.EE 
	WriteLineEE 
(EE 
$"EE  
{EE  !
nameEE! %
,EE% &
-EE& '
$numEE' )
}EE) *
$strEE* /
{EE/ 0
entityEE0 6
.EE6 7
HealthEE7 =
}EE= >
"EE> ?
)EE? @
;EE@ A
}FF 	
}GG 
}HH 
publicLL 
	interfaceLL 
IDamageableLL 
:LL 
IDomainLL &
{MM 
intNN 
HealthNN 
{NN 
getNN 
;NN 
setNN 
;NN 
}NN 
}OO 
publicQQ 
	interfaceQQ 
IMovableQQ 
:QQ 
IDomainQQ #
{RR 
floatSS 	
XSS
 
{SS 
getSS 
;SS 
setSS 
;SS 
}SS 
floatTT 	
YTT
 
{TT 
getTT 
;TT 
setTT 
;TT 
}TT 
}UU 
publicYY 
classYY 
	GameWorldYY 
:YY 
BranchDomainYY %
{ZZ 
private[[ 
readonly[[ 

Dictionary[[ 
<[[  
int[[  #
,[[# $

LeafDomain[[% /
>[[/ 0
	_registry[[1 :
=[[; <
new[[= @
([[@ A
)[[A B
;[[B C
private\\ 
int\\ 
_nextId\\ 
=\\ 
$num\\ 
;\\ 
public^^ 

	GameWorld^^ 
(^^ 
)^^ 
:^^ 
base^^ 
(^^ 
null^^ "
)^^" #
{__ 
new`` 
Reaction`` 
<`` 

LeafDomain`` 
,``  
AddSubdomainAction``! 3
>``3 4
(``4 5
this``5 9
)``9 :
.aa 
Afteraa 
(aa 
(aa 
_aa 
,aa 
actionaa 
)aa 
=>aa !
{bb 
actioncc 
.cc 
Childcc 
.cc 
Idcc 
=cc  !
_nextIdcc" )
++cc) +
;cc+ ,
	_registrydd 
[dd 
actiondd  
.dd  !
Childdd! &
.dd& '
Iddd' )
]dd) *
=dd+ ,
actiondd- 3
.dd3 4
Childdd4 9
;dd9 :
}ee 
)ee 
.ff 
AddToff 
(ff 
Disposablesff 
)ff 
;ff  
}gg 
publicii 


LeafDomainii 
?ii 
	GetDomainii  
(ii  !
intii! $
idii% '
)ii' (
=>ii) +
	_registryjj 
.jj 
TryGetValuejj 
(jj 
idjj  
,jj  !
outjj" %
varjj& )
djj* +
)jj+ ,
?jj- .
djj/ 0
:jj1 2
nulljj3 7
;jj7 8
}kk 
publicpp 
classpp 
Playerpp 
:pp 
BranchDomainpp "
,pp" #
IDamageablepp$ /
,pp/ 0
IMovablepp1 9
{qq 
publicrr 

stringrr 
Namerr 
{rr 
getrr 
;rr 
}rr 
publicss 

intss 
Healthss 
{ss 
getss 
;ss 
setss  
;ss  !
}ss" #
publictt 

floattt 
Xtt 
{tt 
gettt 
;tt 
settt 
;tt 
}tt  
publicuu 

floatuu 
Yuu 
{uu 
getuu 
;uu 
setuu 
;uu 
}uu  
publicww 

Playerww 
(ww 
BranchDomainww 
parentww %
,ww% &
stringww' -
nameww. 2
)ww2 3
:ww4 5
baseww6 :
(ww: ;
parentww; A
)wwA B
{xx 
Nameyy 
=yy 
nameyy 
;yy 
}zz 
}{{ 
public~~ 
class~~ 
Enemy~~ 
:~~ 
BranchDomain~~ !
,~~! "
IDamageable~~# .
,~~. /
IMovable~~0 8
{ 
public
ÄÄ 

string
ÄÄ 
Type
ÄÄ 
{
ÄÄ 
get
ÄÄ 
;
ÄÄ 
}
ÄÄ 
public
ÅÅ 

int
ÅÅ 
Health
ÅÅ 
{
ÅÅ 
get
ÅÅ 
;
ÅÅ 
set
ÅÅ  
;
ÅÅ  !
}
ÅÅ" #
public
ÇÇ 

float
ÇÇ 
X
ÇÇ 
{
ÇÇ 
get
ÇÇ 
;
ÇÇ 
set
ÇÇ 
;
ÇÇ 
}
ÇÇ  
public
ÉÉ 

float
ÉÉ 
Y
ÉÉ 
{
ÉÉ 
get
ÉÉ 
;
ÉÉ 
set
ÉÉ 
;
ÉÉ 
}
ÉÉ  
public
ÖÖ 

Enemy
ÖÖ 
(
ÖÖ 
BranchDomain
ÖÖ 
parent
ÖÖ $
,
ÖÖ$ %
string
ÖÖ& ,
type
ÖÖ- 1
)
ÖÖ1 2
:
ÖÖ3 4
base
ÖÖ5 9
(
ÖÖ9 :
parent
ÖÖ: @
)
ÖÖ@ A
{
ÜÜ 
Type
áá 
=
áá 
type
áá 
;
áá 
}
àà 
}ââ 
publicåå 
class
åå 
Wall
åå 
:
åå 

LeafDomain
åå 
,
åå 
IDamageable
åå  +
{çç 
public
éé 

int
éé 
Health
éé 
{
éé 
get
éé 
;
éé 
set
éé  
;
éé  !
}
éé" #
public
êê 

Wall
êê 
(
êê 
BranchDomain
êê 
parent
êê #
)
êê# $
:
êê% &
base
êê' +
(
êê+ ,
parent
êê, 2
)
êê2 3
{
ëë 
}
íí 
}ìì 
publicññ 
class
ññ 
Bullet
ññ 
:
ññ 

LeafDomain
ññ  
,
ññ  !
IDamageable
ññ" -
,
ññ- .
IMovable
ññ/ 7
{óó 
public
òò 

int
òò 
Health
òò 
{
òò 
get
òò 
;
òò 
set
òò  
;
òò  !
}
òò" #
public
ôô 

float
ôô 
X
ôô 
{
ôô 
get
ôô 
;
ôô 
set
ôô 
;
ôô 
}
ôô  
public
öö 

float
öö 
Y
öö 
{
öö 
get
öö 
;
öö 
set
öö 
;
öö 
}
öö  
public
úú 

Bullet
úú 
(
úú 
BranchDomain
úú 
parent
úú %
)
úú% &
:
úú' (
base
úú) -
(
úú- .
parent
úú. 4
)
úú4 5
{
ùù 
}
ûû 
}üü 
public¢¢ 
class
¢¢ 
ArmorComponent
¢¢ 
:
¢¢ 

LeafDomain
¢¢ (
{££ 
public
§§ 

int
§§ 
Defense
§§ 
{
§§ 
get
§§ 
;
§§ 
set
§§ !
;
§§! "
}
§§# $
public
¶¶ 

ArmorComponent
¶¶ 
(
¶¶ 
BranchDomain
¶¶ &
parent
¶¶' -
)
¶¶- .
:
¶¶/ 0
base
¶¶1 5
(
¶¶5 6
parent
¶¶6 <
)
¶¶< =
{
ßß 
}
®® 
}©© 
publicÆÆ 
class
ÆÆ 
DamageAction
ÆÆ 
:
ÆÆ 
	DARAction
ÆÆ %
<
ÆÆ% &
IDamageable
ÆÆ& 1
,
ÆÆ1 2
DamageAction
ÆÆ3 ?
>
ÆÆ? @
{ØØ 
[
∞∞ 
JsonProperty
∞∞ 
]
∞∞ 
public
∞∞ 
int
∞∞ 
Amount
∞∞ $
{
∞∞% &
get
∞∞' *
;
∞∞* +
set
∞∞, /
;
∞∞/ 0
}
∞∞1 2
	protected
≤≤ 
override
≤≤ 
void
≤≤ 
ExecuteProcess
≤≤ *
(
≤≤* +
IDamageable
≤≤+ 6
target
≤≤7 =
)
≤≤= >
{
≥≥ 
target
¥¥ 
.
¥¥ 
Health
¥¥ 
-=
¥¥ 
Amount
¥¥ 
;
¥¥  
var
∂∂ 
name
∂∂ 
=
∂∂ 
target
∂∂ 
switch
∂∂  
{
∑∑ 	
Player
∏∏ 
p
∏∏ 
=>
∏∏ 
$"
∏∏ 
$str
∏∏ "
{
∏∏" #
p
∏∏# $
.
∏∏$ %
Name
∏∏% )
}
∏∏) *
$str
∏∏* +
"
∏∏+ ,
,
∏∏, -
Enemy
ππ 
e
ππ 
=>
ππ 
$"
ππ 
$str
ππ  
{
ππ  !
e
ππ! "
.
ππ" #
Type
ππ# '
}
ππ' (
$str
ππ( )
"
ππ) *
,
ππ* +
Wall
∫∫ 
=>
∫∫ 
$str
∫∫ 
,
∫∫ 
Bullet
ªª 
=>
ªª 
$str
ªª 
,
ªª 
_
ºº 
=>
ºº 
$str
ºº 
}
ΩΩ 	
;
ΩΩ	 

Console
øø 
.
øø 
	WriteLine
øø 
(
øø 
$"
øø 
$str
øø  
{
øø  !
name
øø! %
}
øø% &
$str
øø& ,
{
øø, -
Amount
øø- 3
}
øø3 4
$str
øø4 ;
"
øø; <
)
øø< =
;
øø= >
}
¿¿ 
}¡¡ 
publicƒƒ 
class
ƒƒ 

MoveAction
ƒƒ 
:
ƒƒ 
	DARAction
ƒƒ #
<
ƒƒ# $
IMovable
ƒƒ$ ,
,
ƒƒ, -

MoveAction
ƒƒ. 8
>
ƒƒ8 9
{≈≈ 
[
∆∆ 
JsonProperty
∆∆ 
]
∆∆ 
public
∆∆ 
float
∆∆ 
DeltaX
∆∆  &
{
∆∆' (
get
∆∆) ,
;
∆∆, -
set
∆∆. 1
;
∆∆1 2
}
∆∆3 4
[
«« 
JsonProperty
«« 
]
«« 
public
«« 
float
«« 
DeltaY
««  &
{
««' (
get
««) ,
;
««, -
set
««. 1
;
««1 2
}
««3 4
	protected
…… 
override
…… 
void
…… 
ExecuteProcess
…… *
(
……* +
IMovable
……+ 3
target
……4 :
)
……: ;
{
   
target
ÀÀ 
.
ÀÀ 
X
ÀÀ 
+=
ÀÀ 
DeltaX
ÀÀ 
;
ÀÀ 
target
ÃÃ 
.
ÃÃ 
Y
ÃÃ 
+=
ÃÃ 
DeltaY
ÃÃ 
;
ÃÃ 
}
ÕÕ 
}ŒŒ ÜD
î/Users/a1/Documents/GitHub/turn-based-prototype/Server/Framework/Deterministic.GameFramework.Examples/Examples/Advanced/Example06_ActionInjection.cs
	namespace 	
Deterministic
 
. 
GameFramework %
.% &
Examples& .
.. /
Advanced/ 7
;7 8
public 
static 
class %
Example06_ActionInjection -
{ 
public 

static 
void 
Run 
( 
) 
{ 
var 
game 
= 
new 
SimpleGameState &
(& '
)' (
;( )
var 
knight 
= 
new 
Unit 
( 
game "
," #
$str$ ,
), -
{. /
Attack0 6
=7 8
$num9 ;
}< =
;= >
var 
goblin 
= 
new 
Unit 
( 
game "
," #
$str$ ,
), -
{. /
Health0 6
=7 8
$num9 ;
}< =
;= >
Console 
. 
	WriteLine 
( 
$" 
$str '
{' (
knight( .
.. /
Id/ 1
}1 2
$str2 ?
{? @
goblin@ F
.F G
IdG I
}I J
"J K
)K L
;L M
Console 
. 
	WriteLine 
( 
$" 
$str 0
{0 1
goblin1 7
.7 8
Health8 >
}> ?
"? @
)@ A
;A B
var 
action 
= 
new 
AttackAction %
{& '
TargetId( 0
=1 2
goblin3 9
.9 :
Id: <
}= >
;> ?
var 
json 
= 
JsonConvert 
. 
SerializeObject .
(. /
action/ 5
)5 6
;6 7
Console 
. 
	WriteLine 
( 
$" 
$str (
{( )
json) -
}- .
". /
)/ 0
;0 1
var 
received 
= 
JsonConvert "
." #
DeserializeObject# 4
<4 5
AttackAction5 A
>A B
(B C
jsonC G
)G H
!H I
;I J
received"" 
."" 
Execute"" 
("" 
knight"" 
)""  
;""  !
Console$$ 
.$$ 
	WriteLine$$ 
($$ 
$"$$ 
$str$$ /
{$$/ 0
goblin$$0 6
.$$6 7
Health$$7 =
}$$= >
"$$> ?
)$$? @
;$$@ A
game&& 
.&& 
Dispose&& 
(&& 
)&& 
;&& 
}'' 
}(( 
public,, 
	interface,, 
IRequireGame,, 
:,, 

IDARAction,,  *
{-- 
SimpleGameState.. 
Game.. 
{.. 
get.. 
;.. 
set..  #
;..# $
}..% &
}// 
public33 
class33 
SimpleGameState33 
:33 
BranchDomain33 +
{44 
private55 
readonly55 

Dictionary55 
<55  
int55  #
,55# $

LeafDomain55% /
>55/ 0
	_registry551 :
=55; <
new55= @
(55@ A
)55A B
;55B C
private66 
int66 
_nextId66 
=66 
$num66 
;66 
public88 

SimpleGameState88 
(88 
)88 
:88 
base88 #
(88# $
null88$ (
)88( )
{99 
new;; 
Reaction;; 
<;; 

LeafDomain;; 
,;;  
IRequireGame;;! -
>;;- .
(;;. /
this;;/ 3
);;3 4
.<< 
Prepare<< 
(<< 
(<< 
_<< 
,<< 
action<< 
)<<  
=><<! #
action<<$ *
.<<* +
Game<<+ /
=<<0 1
this<<2 6
)<<6 7
.== 
AddTo== 
(== 
Disposables== 
)== 
;==  
new@@ 
Reaction@@ 
<@@ 

LeafDomain@@ 
,@@  
AddSubdomainAction@@! 3
>@@3 4
(@@4 5
this@@5 9
)@@9 :
.AA 
AfterAA 
(AA 
(AA 
_AA 
,AA 
actionAA 
)AA 
=>AA !
{BB 
actionCC 
.CC 
ChildCC 
.CC 
IdCC 
=CC  !
_nextIdCC" )
++CC) +
;CC+ ,
	_registryDD 
[DD 
actionDD  
.DD  !
ChildDD! &
.DD& '
IdDD' )
]DD) *
=DD+ ,
actionDD- 3
.DD3 4
ChildDD4 9
;DD9 :
}EE 
)EE 
.FF 
AddToFF 
(FF 
DisposablesFF 
)FF 
;FF  
}GG 
publicII 


LeafDomainII 
?II 
	GetDomainII  
(II  !
intII! $
idII% '
)II' (
=>II) +
	_registryJJ 
.JJ 
TryGetValueJJ 
(JJ 
idJJ  
,JJ  !
outJJ" %
varJJ& )
dJJ* +
)JJ+ ,
?JJ- .
dJJ/ 0
:JJ1 2
nullJJ3 7
;JJ7 8
}KK 
publicMM 
classMM 
UnitMM 
:MM 
BranchDomainMM  
{NN 
publicOO 

stringOO 
NameOO 
{OO 
getOO 
;OO 
}OO 
publicPP 

intPP 
HealthPP 
{PP 
getPP 
;PP 
setPP  
;PP  !
}PP" #
=PP$ %
$numPP& )
;PP) *
publicQQ 

intQQ 
AttackQQ 
{QQ 
getQQ 
;QQ 
setQQ  
;QQ  !
}QQ" #
=QQ$ %
$numQQ& (
;QQ( )
publicSS 

UnitSS 
(SS 
BranchDomainSS 
parentSS #
,SS# $
stringSS% +
nameSS, 0
)SS0 1
:SS2 3
baseSS4 8
(SS8 9
parentSS9 ?
)SS? @
{TT 
NameUU 
=UU 
nameUU 
;UU 
}VV 
}WW 
public[[ 
class[[ 
AttackAction[[ 
:[[ 
	DARAction[[ %
<[[% &
Unit[[& *
,[[* +
AttackAction[[, 8
>[[8 9
,[[9 :
IRequireGame[[; G
{\\ 
[]] 

JsonIgnore]] 
]]] 
public]] 
SimpleGameState]] '
Game]]( ,
{]]- .
get]]/ 2
;]]2 3
set]]4 7
;]]7 8
}]]9 :
[__ 
JsonProperty__ 
]__ 
public__ 
int__ 
TargetId__ &
{__' (
get__) ,
;__, -
set__. 1
;__1 2
}__3 4
	protectedaa 
overrideaa 
voidaa 
ExecuteProcessaa *
(aa* +
Unitaa+ /
attackeraa0 8
)aa8 9
{bb 
vardd 
targetdd 
=dd 
Gamedd 
.dd 
	GetDomaindd #
(dd# $
TargetIddd$ ,
)dd, -
asdd. 0
Unitdd1 5
;dd5 6
ifee 

(ee 
targetee 
==ee 
nullee 
)ee 
returnee "
;ee" #
targetgg 
.gg 
Healthgg 
-=gg 
attackergg !
.gg! "
Attackgg" (
;gg( )
Consolehh 
.hh 
	WriteLinehh 
(hh 
$"hh 
{hh 
attackerhh %
.hh% &
Namehh& *
}hh* +
$strhh+ 4
{hh4 5
targethh5 ;
.hh; <
Namehh< @
}hh@ A
$strhhA F
{hhF G
attackerhhG O
.hhO P
AttackhhP V
}hhV W
$strhhW ^
"hh^ _
)hh_ `
;hh` a
}ii 
}jj 